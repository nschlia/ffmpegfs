<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.4"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>FFmpegfs Fuse Multi Media Filesystem: src/transcode.cc File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">FFmpegfs Fuse Multi Media Filesystem<span id="projectnumber">&#160;2.16</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.4 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">transcode.cc File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>File transcoder interface implementation.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="transcode_8h_source.html">transcode.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="ffmpegfs_8h_source.html">ffmpegfs.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="ffmpeg__transcoder_8h_source.html">ffmpeg_transcoder.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="buffer_8h_source.html">buffer.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="cache_8h_source.html">cache.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="logging_8h_source.html">logging.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="cache__entry_8h_source.html">cache_entry.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="thread__pool_8h_source.html">thread_pool.h</a>&quot;</code><br />
<code>#include &lt;unistd.h&gt;</code><br />
<code>#include &lt;atomic&gt;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for transcode.cc:</div>
<div class="dyncontent">
<div class="center"><img src="transcode_8cc__incl.png" border="0" usemap="#asrc_2transcode_8cc" alt=""/></div>
<map name="asrc_2transcode_8cc" id="asrc_2transcode_8cc">
<area shape="rect" title="File transcoder interface implementation." alt="" coords="1181,5,1299,32"/>
<area shape="rect" href="transcode_8h.html" title="File transcoder interface (for use with by FUSE)" alt="" coords="116,155,207,181"/>
<area shape="rect" href="ffmpegfs_8h.html" title="Main include for FFmpegfs project." alt="" coords="37,229,121,256"/>
<area shape="rect" href="ffmpeg__transcoder_8h.html" title="FFmpeg transcoder." alt="" coords="791,155,931,181"/>
<area shape="rect" title=" " alt="" coords="1285,229,1347,256"/>
<area shape="rect" href="buffer_8h.html" title="Buffer class." alt="" coords="1145,229,1210,256"/>
<area shape="rect" href="cache_8h.html" title="Data cache management." alt="" coords="1109,155,1177,181"/>
<area shape="rect" href="logging_8h.html" title="Provide various log facilities to stderr, disk or syslog." alt="" coords="2133,229,2208,256"/>
<area shape="rect" href="cache__entry_8h.html" title="Cache entry" alt="" coords="1074,80,1177,107"/>
<area shape="rect" href="thread__pool_8h.html" title="Thread pool class implementation." alt="" coords="1597,155,1697,181"/>
<area shape="rect" title=" " alt="" coords="2041,229,2109,256"/>
<area shape="rect" href="fileio_8h.html" title="FileIO class." alt="" coords="250,304,310,331"/>
<area shape="rect" title=" " alt="" coords="5,304,64,331"/>
<area shape="rect" title=" " alt="" coords="88,304,157,331"/>
<area shape="rect" href="ffmpeg__utils_8h.html" title="Various FFmpegfs utility functions." alt="" coords="677,304,781,331"/>
<area shape="rect" href="ffmpeg__compat_8h.html" title="FFmpeg API compatibility." alt="" coords="487,379,609,405"/>
<area shape="rect" title=" " alt="" coords="407,379,462,405"/>
<area shape="rect" title=" " alt="" coords="1139,379,1197,405"/>
<area shape="rect" title=" " alt="" coords="1857,379,1911,405"/>
<area shape="rect" title=" " alt="" coords="633,379,673,405"/>
<area shape="rect" title=" " alt="" coords="332,379,383,405"/>
<area shape="rect" title=" " alt="" coords="698,379,761,405"/>
<area shape="rect" title=" " alt="" coords="785,379,845,405"/>
<area shape="rect" title=" " alt="" coords="869,379,1021,405"/>
<area shape="rect" title=" " alt="" coords="143,379,223,405"/>
<area shape="rect" title=" " alt="" coords="1465,379,1511,405"/>
<area shape="rect" title=" " alt="" coords="247,379,308,405"/>
<area shape="rect" title=" " alt="" coords="1045,379,1115,405"/>
<area shape="rect" title=" " alt="" coords="7,379,119,405"/>
<area shape="rect" href="ffmpeg__base_8h.html" title="FFmpeg transcoder base." alt="" coords="491,229,599,256"/>
<area shape="rect" href="ffmpeg__frame_8h.html" title="FFmpeg AVFrame extension." alt="" coords="354,229,467,256"/>
<area shape="rect" href="ffmpeg__subtitle_8h.html" title="FFmpeg AVSubtitle extension." alt="" coords="947,229,1069,256"/>
<area shape="rect" href="id3v1tag_8h.html" title="ID3v1 tag structure" alt="" coords="247,229,329,256"/>
<area shape="rect" href="ffmpeg__profiles_8h.html" title="FFmpeg encoder profiles." alt="" coords="800,229,923,256"/>
<area shape="rect" title=" " alt="" coords="1526,229,1583,256"/>
<area shape="rect" title=" " alt="" coords="1551,304,1609,331"/>
<area shape="rect" title=" " alt="" coords="624,229,685,256"/>
<area shape="rect" title=" " alt="" coords="1371,229,1450,256"/>
<area shape="rect" title=" " alt="" coords="709,229,776,256"/>
<area shape="rect" title=" " alt="" coords="1205,304,1275,331"/>
<area shape="rect" title=" " alt="" coords="2101,304,2168,331"/>
<area shape="rect" title=" " alt="" coords="2008,304,2077,331"/>
<area shape="rect" title=" " alt="" coords="1944,229,2016,256"/>
<area shape="rect" title=" " alt="" coords="1709,229,1768,256"/>
<area shape="rect" title=" " alt="" coords="1793,229,1919,256"/>
</map>
</div>
</div>
<p><a href="transcode_8cc_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structTHREAD__DATA.html">THREAD_DATA</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="structTHREAD__DATA.html" title="THREAD_DATA struct to pass data from parent to child thread.">THREAD_DATA</a> struct to pass data from parent to child thread.  <a href="structTHREAD__DATA.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="typedef-members" name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:a18e7762ab088daab6ce7a33532d9351e"><td class="memItemLeft" align="right" valign="top"><a id="a18e7762ab088daab6ce7a33532d9351e" name="a18e7762ab088daab6ce7a33532d9351e"></a>
typedef struct <a class="el" href="structTHREAD__DATA.html">THREAD_DATA</a>&#160;</td><td class="memItemRight" valign="bottom"><b>THREAD_DATA</b></td></tr>
<tr class="memdesc:a18e7762ab088daab6ce7a33532d9351e"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="structTHREAD__DATA.html" title="THREAD_DATA struct to pass data from parent to child thread.">THREAD_DATA</a> struct to pass data from parent to child thread. <br /></td></tr>
<tr class="separator:a18e7762ab088daab6ce7a33532d9351e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a14fb96a00ba296909b3870e3047b3633"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="transcode_8cc.html#a14fb96a00ba296909b3870e3047b3633">transcode</a> (std::shared_ptr&lt; <a class="el" href="structTHREAD__DATA.html">THREAD_DATA</a> &gt; thread_data, <a class="el" href="classCache__Entry.html">Cache_Entry</a> *cache_entry, <a class="el" href="classFFmpeg__Transcoder.html">FFmpeg_Transcoder</a> &amp;transcoder, bool *timeout)</td></tr>
<tr class="memdesc:a14fb96a00ba296909b3870e3047b3633"><td class="mdescLeft">&#160;</td><td class="mdescRight">Actually transcode file.  <a href="transcode_8cc.html#a14fb96a00ba296909b3870e3047b3633">More...</a><br /></td></tr>
<tr class="separator:a14fb96a00ba296909b3870e3047b3633"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae6ac280210471b832da4e4661d5d9209"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="transcode_8cc.html#ae6ac280210471b832da4e4661d5d9209">transcoder_thread</a> (std::shared_ptr&lt; <a class="el" href="structTHREAD__DATA.html">THREAD_DATA</a> &gt; thread_data)</td></tr>
<tr class="memdesc:ae6ac280210471b832da4e4661d5d9209"><td class="mdescLeft">&#160;</td><td class="mdescRight">Transcoding thread.  <a href="transcode_8cc.html#ae6ac280210471b832da4e4661d5d9209">More...</a><br /></td></tr>
<tr class="separator:ae6ac280210471b832da4e4661d5d9209"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a081aa7e4eb108b9ce0150cee5f5d4fe4"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="transcode_8cc.html#a081aa7e4eb108b9ce0150cee5f5d4fe4">transcode_until</a> (<a class="el" href="classCache__Entry.html">Cache_Entry</a> *cache_entry, size_t offset, size_t len, uint32_t segment_no)</td></tr>
<tr class="memdesc:a081aa7e4eb108b9ce0150cee5f5d4fe4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Transcode the buffer until the buffer has enough or until an error occurs. The buffer needs at least 'end' bytes before transcoding stops. Returns true if no errors and false otherwise.  <a href="transcode_8cc.html#a081aa7e4eb108b9ce0150cee5f5d4fe4">More...</a><br /></td></tr>
<tr class="separator:a081aa7e4eb108b9ce0150cee5f5d4fe4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9829a0962abb0def61a28bef699fb859"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="transcode_8cc.html#a9829a0962abb0def61a28bef699fb859">transcode_finish</a> (<a class="el" href="classCache__Entry.html">Cache_Entry</a> *cache_entry, <a class="el" href="classFFmpeg__Transcoder.html">FFmpeg_Transcoder</a> &amp;transcoder)</td></tr>
<tr class="memdesc:a9829a0962abb0def61a28bef699fb859"><td class="mdescLeft">&#160;</td><td class="mdescRight">Close the input file and free everything but the initial buffer.  <a href="transcode_8cc.html#a9829a0962abb0def61a28bef699fb859">More...</a><br /></td></tr>
<tr class="separator:a9829a0962abb0def61a28bef699fb859"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3cd7e2e6abc840f21c8957f2f24425b3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="transcode_8cc.html#a3cd7e2e6abc840f21c8957f2f24425b3">transcoder_cache_path</a> (std::string *path)</td></tr>
<tr class="memdesc:a3cd7e2e6abc840f21c8957f2f24425b3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get transcoder cache path.  <a href="transcode_8cc.html#a3cd7e2e6abc840f21c8957f2f24425b3">More...</a><br /></td></tr>
<tr class="separator:a3cd7e2e6abc840f21c8957f2f24425b3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab94b13295817a6faab86611c4ed5afc1"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="transcode_8cc.html#ab94b13295817a6faab86611c4ed5afc1">transcoder_init</a> ()</td></tr>
<tr class="memdesc:ab94b13295817a6faab86611c4ed5afc1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialise transcoder, create cache.  <a href="transcode_8cc.html#ab94b13295817a6faab86611c4ed5afc1">More...</a><br /></td></tr>
<tr class="separator:ab94b13295817a6faab86611c4ed5afc1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7b9eeffdb94ced039971a18ef11779c5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="transcode_8cc.html#a7b9eeffdb94ced039971a18ef11779c5">transcoder_free</a> ()</td></tr>
<tr class="memdesc:a7b9eeffdb94ced039971a18ef11779c5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Free transcoder.  <a href="transcode_8cc.html#a7b9eeffdb94ced039971a18ef11779c5">More...</a><br /></td></tr>
<tr class="separator:a7b9eeffdb94ced039971a18ef11779c5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeaf746244e3f08933d0c1ed855915207"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="transcode_8cc.html#aeaf746244e3f08933d0c1ed855915207">transcoder_cached_filesize</a> (<a class="el" href="fileio_8h.html#ae8356f209b2b74cc385a8d7551f1f27a">LPVIRTUALFILE</a> virtualfile, struct stat *stbuf)</td></tr>
<tr class="memdesc:aeaf746244e3f08933d0c1ed855915207"><td class="mdescLeft">&#160;</td><td class="mdescRight">Simply get encoded file size (do not create the whole encoder/decoder objects)  <a href="transcode_8cc.html#aeaf746244e3f08933d0c1ed855915207">More...</a><br /></td></tr>
<tr class="separator:aeaf746244e3f08933d0c1ed855915207"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4b4a6f7de7c8e817105ab07d331936a8"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="transcode_8cc.html#a4b4a6f7de7c8e817105ab07d331936a8">transcoder_set_filesize</a> (<a class="el" href="fileio_8h.html#ae8356f209b2b74cc385a8d7551f1f27a">LPVIRTUALFILE</a> virtualfile, int64_t duration, <a class="el" href="ffmpeg__utils_8h.html#a17468d10f0c67a4ee7b38aab09d9e096">BITRATE</a> audio_bit_rate, int channels, int sample_rate, AVSampleFormat sample_format, <a class="el" href="ffmpeg__utils_8h.html#a17468d10f0c67a4ee7b38aab09d9e096">BITRATE</a> video_bit_rate, int width, int height, bool interleaved, const AVRational &amp;framerate)</td></tr>
<tr class="memdesc:a4b4a6f7de7c8e817105ab07d331936a8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the file size.  <a href="transcode_8cc.html#a4b4a6f7de7c8e817105ab07d331936a8">More...</a><br /></td></tr>
<tr class="separator:a4b4a6f7de7c8e817105ab07d331936a8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a318fb7fd8dac4f1ab7b350972962b89f"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="transcode_8cc.html#a318fb7fd8dac4f1ab7b350972962b89f">transcoder_predict_filesize</a> (<a class="el" href="fileio_8h.html#ae8356f209b2b74cc385a8d7551f1f27a">LPVIRTUALFILE</a> virtualfile, <a class="el" href="classCache__Entry.html">Cache_Entry</a> *cache_entry)</td></tr>
<tr class="memdesc:a318fb7fd8dac4f1ab7b350972962b89f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Predict file size.  <a href="transcode_8cc.html#a318fb7fd8dac4f1ab7b350972962b89f">More...</a><br /></td></tr>
<tr class="separator:a318fb7fd8dac4f1ab7b350972962b89f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a473016e27c83fb4113497baab16ff574"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classCache__Entry.html">Cache_Entry</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="transcode_8cc.html#a473016e27c83fb4113497baab16ff574">transcoder_new</a> (<a class="el" href="fileio_8h.html#ae8356f209b2b74cc385a8d7551f1f27a">LPVIRTUALFILE</a> virtualfile, bool begin_transcode)</td></tr>
<tr class="memdesc:a473016e27c83fb4113497baab16ff574"><td class="mdescLeft">&#160;</td><td class="mdescRight">Allocate and initialise the transcoder.  <a href="transcode_8cc.html#a473016e27c83fb4113497baab16ff574">More...</a><br /></td></tr>
<tr class="separator:a473016e27c83fb4113497baab16ff574"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8f7737e72a5cd08de149c65bbafd7fe7"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="transcode_8cc.html#a8f7737e72a5cd08de149c65bbafd7fe7">transcoder_read</a> (<a class="el" href="classCache__Entry.html">Cache_Entry</a> *cache_entry, char *buff, size_t offset, size_t len, int *bytes_read, uint32_t segment_no)</td></tr>
<tr class="memdesc:a8f7737e72a5cd08de149c65bbafd7fe7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read some bytes from the internal buffer and into the given buffer.  <a href="transcode_8cc.html#a8f7737e72a5cd08de149c65bbafd7fe7">More...</a><br /></td></tr>
<tr class="separator:a8f7737e72a5cd08de149c65bbafd7fe7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaa23ed05d04f3180fa5622f41fe5f702"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="transcode_8cc.html#aaa23ed05d04f3180fa5622f41fe5f702">transcoder_read_frame</a> (<a class="el" href="classCache__Entry.html">Cache_Entry</a> *cache_entry, char *buff, size_t offset, size_t len, uint32_t frame_no, int *bytes_read, <a class="el" href="fileio_8h.html#ae8356f209b2b74cc385a8d7551f1f27a">LPVIRTUALFILE</a> virtualfile)</td></tr>
<tr class="memdesc:aaa23ed05d04f3180fa5622f41fe5f702"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read one image frame from the internal buffer and into the given buffer.  <a href="transcode_8cc.html#aaa23ed05d04f3180fa5622f41fe5f702">More...</a><br /></td></tr>
<tr class="separator:aaa23ed05d04f3180fa5622f41fe5f702"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afa40f1d11c536c0267ff99aa7f2900c6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="transcode_8cc.html#afa40f1d11c536c0267ff99aa7f2900c6">transcoder_delete</a> (<a class="el" href="classCache__Entry.html">Cache_Entry</a> *cache_entry)</td></tr>
<tr class="memdesc:afa40f1d11c536c0267ff99aa7f2900c6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Free the cache entry structure.  <a href="transcode_8cc.html#afa40f1d11c536c0267ff99aa7f2900c6">More...</a><br /></td></tr>
<tr class="separator:afa40f1d11c536c0267ff99aa7f2900c6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa5d36e6c898b599099ee24f3bc6b7585"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="transcode_8cc.html#aa5d36e6c898b599099ee24f3bc6b7585">transcoder_get_size</a> (<a class="el" href="classCache__Entry.html">Cache_Entry</a> *cache_entry)</td></tr>
<tr class="memdesc:aa5d36e6c898b599099ee24f3bc6b7585"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return size of output file, as computed by encoder.  <a href="transcode_8cc.html#aa5d36e6c898b599099ee24f3bc6b7585">More...</a><br /></td></tr>
<tr class="separator:aa5d36e6c898b599099ee24f3bc6b7585"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad7868030f5aead82e78204b1b4c6e8ba"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="transcode_8cc.html#ad7868030f5aead82e78204b1b4c6e8ba">transcoder_buffer_watermark</a> (<a class="el" href="classCache__Entry.html">Cache_Entry</a> *cache_entry, uint32_t segment_no)</td></tr>
<tr class="memdesc:ad7868030f5aead82e78204b1b4c6e8ba"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return the current watermark of the file while transcoding.  <a href="transcode_8cc.html#ad7868030f5aead82e78204b1b4c6e8ba">More...</a><br /></td></tr>
<tr class="separator:ad7868030f5aead82e78204b1b4c6e8ba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a82aa9ff8545f292b3236f9de19f4c65d"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="transcode_8cc.html#a82aa9ff8545f292b3236f9de19f4c65d">transcoder_buffer_tell</a> (<a class="el" href="classCache__Entry.html">Cache_Entry</a> *cache_entry, uint32_t segment_no)</td></tr>
<tr class="memdesc:a82aa9ff8545f292b3236f9de19f4c65d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return the current file position in the file.  <a href="transcode_8cc.html#a82aa9ff8545f292b3236f9de19f4c65d">More...</a><br /></td></tr>
<tr class="separator:a82aa9ff8545f292b3236f9de19f4c65d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa523c3a9437882cd71e010577aab8249"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="transcode_8cc.html#aa523c3a9437882cd71e010577aab8249">transcoder_exit</a> ()</td></tr>
<tr class="memdesc:aa523c3a9437882cd71e010577aab8249"><td class="mdescLeft">&#160;</td><td class="mdescRight">Exit transcoding.  <a href="transcode_8cc.html#aa523c3a9437882cd71e010577aab8249">More...</a><br /></td></tr>
<tr class="separator:aa523c3a9437882cd71e010577aab8249"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aebae3dec0e78bdcd14cc4721f5b6efeb"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="transcode_8cc.html#aebae3dec0e78bdcd14cc4721f5b6efeb">transcoder_cache_maintenance</a> ()</td></tr>
<tr class="memdesc:aebae3dec0e78bdcd14cc4721f5b6efeb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Run cache maintenance.  <a href="transcode_8cc.html#aebae3dec0e78bdcd14cc4721f5b6efeb">More...</a><br /></td></tr>
<tr class="separator:aebae3dec0e78bdcd14cc4721f5b6efeb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae63249b0134b3b6bc8524fd809c46319"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="transcode_8cc.html#ae63249b0134b3b6bc8524fd809c46319">transcoder_cache_clear</a> ()</td></tr>
<tr class="memdesc:ae63249b0134b3b6bc8524fd809c46319"><td class="mdescLeft">&#160;</td><td class="mdescRight">Clear transcoder cache.  <a href="transcode_8cc.html#ae63249b0134b3b6bc8524fd809c46319">More...</a><br /></td></tr>
<tr class="separator:ae63249b0134b3b6bc8524fd809c46319"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a80b544d9fd59324f5124c9ae0d535941"><td class="memItemLeft" align="right" valign="top">const int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="transcode_8cc.html#a80b544d9fd59324f5124c9ae0d535941">GRANULARITY</a> = 250</td></tr>
<tr class="memdesc:a80b544d9fd59324f5124c9ae0d535941"><td class="mdescLeft">&#160;</td><td class="mdescRight">Image frame conversion: ms between checks if a picture frame is available.  <a href="transcode_8cc.html#a80b544d9fd59324f5124c9ae0d535941">More...</a><br /></td></tr>
<tr class="separator:a80b544d9fd59324f5124c9ae0d535941"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aece72d904a40c179fd108ddd5a3fd555"><td class="memItemLeft" align="right" valign="top">const int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="transcode_8cc.html#aece72d904a40c179fd108ddd5a3fd555">FRAME_TIMEOUT</a> = 60</td></tr>
<tr class="memdesc:aece72d904a40c179fd108ddd5a3fd555"><td class="mdescLeft">&#160;</td><td class="mdescRight">Image frame conversion: timout seconds to wait if a picture frame is available.  <a href="transcode_8cc.html#aece72d904a40c179fd108ddd5a3fd555">More...</a><br /></td></tr>
<tr class="separator:aece72d904a40c179fd108ddd5a3fd555"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a16b35c3c2fab1ce85fb27d3abed7797b"><td class="memItemLeft" align="right" valign="top">const int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="transcode_8cc.html#a16b35c3c2fab1ce85fb27d3abed7797b">TOTAL_RETRIES</a> = <a class="el" href="transcode_8cc.html#aece72d904a40c179fd108ddd5a3fd555">FRAME_TIMEOUT</a>*1000/<a class="el" href="transcode_8cc.html#a80b544d9fd59324f5124c9ae0d535941">GRANULARITY</a></td></tr>
<tr class="memdesc:a16b35c3c2fab1ce85fb27d3abed7797b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Number of retries.  <a href="transcode_8cc.html#a16b35c3c2fab1ce85fb27d3abed7797b">More...</a><br /></td></tr>
<tr class="separator:a16b35c3c2fab1ce85fb27d3abed7797b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5461162a9673eae67fac6461f26feeaa"><td class="memItemLeft" align="right" valign="top">static std::unique_ptr&lt; <a class="el" href="classCache.html">Cache</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="transcode_8cc.html#a5461162a9673eae67fac6461f26feeaa">cache</a></td></tr>
<tr class="memdesc:a5461162a9673eae67fac6461f26feeaa"><td class="mdescLeft">&#160;</td><td class="mdescRight">Global cache manager object.  <a href="transcode_8cc.html#a5461162a9673eae67fac6461f26feeaa">More...</a><br /></td></tr>
<tr class="separator:a5461162a9673eae67fac6461f26feeaa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a36e64cbe664ab3b2b8ca1b823a895d23"><td class="memItemLeft" align="right" valign="top">static std::atomic_bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="transcode_8cc.html#a36e64cbe664ab3b2b8ca1b823a895d23">thread_exit</a></td></tr>
<tr class="memdesc:a36e64cbe664ab3b2b8ca1b823a895d23"><td class="mdescLeft">&#160;</td><td class="mdescRight">Used for shutdown: if true, forcibly exit all threads.  <a href="transcode_8cc.html#a36e64cbe664ab3b2b8ca1b823a895d23">More...</a><br /></td></tr>
<tr class="separator:a36e64cbe664ab3b2b8ca1b823a895d23"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p >File transcoder interface implementation. </p>
<dl class="section author"><dt>Author</dt><dd>Norbert Schlia (<a href="#" onclick="location.href='mai'+'lto:'+'nsc'+'hl'+'ia@'+'ob'+'liv'+'io'+'n-s'+'of'+'twa'+'re'+'.de'; return false;">nschl<span class="obfuscator">.nosp@m.</span>ia@o<span class="obfuscator">.nosp@m.</span>blivi<span class="obfuscator">.nosp@m.</span>on-s<span class="obfuscator">.nosp@m.</span>oftwa<span class="obfuscator">.nosp@m.</span>re.d<span class="obfuscator">.nosp@m.</span>e</a>) </dd></dl>
<dl class="section copyright"><dt>Copyright</dt><dd>Copyright (C) 2006-2008 David Collett <br  />
Copyright (C) 2008-2013 K. Henriksson <br  />
Copyright (C) 2017-2024 FFmpeg support by Norbert Schlia (<a href="#" onclick="location.href='mai'+'lto:'+'nsc'+'hl'+'ia@'+'ob'+'liv'+'io'+'n-s'+'of'+'twa'+'re'+'.de'; return false;">nschl<span class="obfuscator">.nosp@m.</span>ia@o<span class="obfuscator">.nosp@m.</span>blivi<span class="obfuscator">.nosp@m.</span>on-s<span class="obfuscator">.nosp@m.</span>oftwa<span class="obfuscator">.nosp@m.</span>re.d<span class="obfuscator">.nosp@m.</span>e</a>) </dd></dl>

<p class="definition">Definition in file <a class="el" href="transcode_8cc_source.html">transcode.cc</a>.</p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a14fb96a00ba296909b3870e3047b3633" name="a14fb96a00ba296909b3870e3047b3633"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a14fb96a00ba296909b3870e3047b3633">&#9670;&nbsp;</a></span>transcode()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static bool transcode </td>
          <td>(</td>
          <td class="paramtype">std::shared_ptr&lt; <a class="el" href="structTHREAD__DATA.html">THREAD_DATA</a> &gt;&#160;</td>
          <td class="paramname"><em>thread_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classCache__Entry.html">Cache_Entry</a> *&#160;</td>
          <td class="paramname"><em>cache_entry</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classFFmpeg__Transcoder.html">FFmpeg_Transcoder</a> &amp;&#160;</td>
          <td class="paramname"><em>transcoder</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool *&#160;</td>
          <td class="paramname"><em>timeout</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Actually transcode file. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">thread_data</td><td>- Thread data with lock objects </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">cache_entry</td><td>- Underlying thread entry </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">transcoder</td><td>- Transcoder object for transcoding </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">timeout</td><td>- True if transcoding timed out, false if not </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>On success, returns true; on error, returns false </dd></dl>

<p class="definition">Definition at line <a class="el" href="transcode_8cc_source.html#l00775">775</a> of file <a class="el" href="transcode_8cc_source.html">transcode.cc</a>.</p>

<p class="reference">References <a class="el" href="transcode_8cc_source.html#l00063">cache</a>, <a class="el" href="cache__entry_8cc_source.html#l00085">Cache_Entry::clear()</a>, <a class="el" href="ffmpeg__transcoder_8cc_source.html#l06476">FFmpeg_Transcoder::closeio()</a>, <a class="el" href="ffmpegfs_8cc_source.html#l00235">FFMPEGFS_PARAMS::current_format()</a>, <a class="el" href="logging_8h_source.html#l00182">Logging::debug()</a>, <a class="el" href="ffmpeg__transcoder_8h.html#ac7b7ff5fbecde5342c9a7b05c2b6af7ca6b3ee79bed48f0e0cff1f9ce9ed18d30">DEC_EOF</a>, <a class="el" href="ffmpeg__transcoder_8h.html#ac7b7ff5fbecde5342c9a7b05c2b6af7ca021a188cd72cdeae6c402109864378a5">DEC_ERROR</a>, <a class="el" href="ffmpeg__transcoder_8h.html#ac7b7ff5fbecde5342c9a7b05c2b6af7ca82234ebbafaf33c3e4efbc65c821f71d">DEC_SUCCESS</a>, <a class="el" href="cache__entry_8cc_source.html#l00306">Cache_Entry::decode_timeout()</a>, <a class="el" href="ffmpeg__utils_8cc_source.html#l00893">FFmpegfs_Format::desttype()</a>, <a class="el" href="ffmpeg__transcoder_8cc_source.html#l06159">FFmpeg_Transcoder::duration()</a>, <a class="el" href="cache__entry_8cc_source.html#l00311">Cache_Entry::filename()</a>, <a class="el" href="ffmpeg__utils_8cc_source.html#l01630">format_size()</a>, <a class="el" href="ffmpeg__utils_8cc_source.html#l01577">format_time()</a>, <a class="el" href="transcode_8cc_source.html#l00048">GRANULARITY</a>, <a class="el" href="ffmpeg__transcoder_8cc_source.html#l06215">FFmpeg_Transcoder::id3v1tag()</a>, <a class="el" href="logging_8h_source.html#l00201">Logging::info()</a>, <a class="el" href="cache__entry_8cc_source.html#l00435">Cache_Entry::is_finished()</a>, <a class="el" href="ffmpeg__transcoder_8cc_source.html#l06778">FFmpeg_Transcoder::is_frameset()</a>, <a class="el" href="ffmpeg__transcoder_8cc_source.html#l06790">FFmpeg_Transcoder::is_hls()</a>, <a class="el" href="cache_8h_source.html#l00089">CACHE_INFO::m_averror</a>, <a class="el" href="cache__entry_8h_source.html#l00271">Cache_Entry::m_buffer</a>, <a class="el" href="cache__entry_8h_source.html#l00277">Cache_Entry::m_cache_info</a>, <a class="el" href="cache_8h_source.html#l00081">CACHE_INFO::m_duration</a>, <a class="el" href="cache_8h_source.html#l00088">CACHE_INFO::m_errno</a>, <a class="el" href="cache_8h_source.html#l00087">CACHE_INFO::m_error</a>, <a class="el" href="cache__entry_8h_source.html#l00279">Cache_Entry::m_id3v1</a>, <a class="el" href="cache__entry_8h_source.html#l00272">Cache_Entry::m_is_decoding</a>, <a class="el" href="ffmpegfs_8h_source.html#l00243">FFMPEGFS_PARAMS::m_max_inactive_suspend</a>, <a class="el" href="ffmpegfs_8h_source.html#l00246">FFMPEGFS_PARAMS::m_prebuffer_size</a>, <a class="el" href="ffmpegfs_8h_source.html#l00245">FFMPEGFS_PARAMS::m_prebuffer_time</a>, <a class="el" href="cache_8h_source.html#l00082">CACHE_INFO::m_predicted_filesize</a>, <a class="el" href="cache__entry_8h_source.html#l00281">Cache_Entry::m_seek_to_no</a>, <a class="el" href="cache_8h_source.html#l00085">CACHE_INFO::m_segment_count</a>, <a class="el" href="cache__entry_8h_source.html#l00275">Cache_Entry::m_suspend_timeout</a>, <a class="el" href="cache_8h_source.html#l00084">CACHE_INFO::m_video_frame_count</a>, <a class="el" href="ffmpeg__utils_8cc_source.html#l02535">mssleep()</a>, <a class="el" href="ffmpeg__transcoder_8cc_source.html#l00294">FFmpeg_Transcoder::open_input_file()</a>, <a class="el" href="ffmpeg__transcoder_8cc_source.html#l00856">FFmpeg_Transcoder::open_output_file()</a>, <a class="el" href="cache__entry_8cc_source.html#l00160">Cache_Entry::openio()</a>, <a class="el" href="ffmpegfs_8cc_source.html#l00074">params</a>, <a class="el" href="ffmpeg__transcoder_8cc_source.html#l06164">FFmpeg_Transcoder::predicted_filesize()</a>, <a class="el" href="ffmpeg__transcoder_8cc_source.html#l05251">FFmpeg_Transcoder::process_single_fr()</a>, <a class="el" href="ffmpeg__transcoder_8cc_source.html#l07837">FFmpeg_Transcoder::pts()</a>, <a class="el" href="cache__entry_8cc_source.html#l00336">Cache_Entry::ref_count()</a>, <a class="el" href="ffmpeg__transcoder_8cc_source.html#l06174">FFmpeg_Transcoder::segment_count()</a>, <a class="el" href="ffmpeg__transcoder_8cc_source.html#l06733">FFmpeg_Transcoder::stack_seek_frame()</a>, <a class="el" href="ffmpeg__transcoder_8cc_source.html#l06749">FFmpeg_Transcoder::stack_seek_segment()</a>, <a class="el" href="cache__entry_8cc_source.html#l00301">Cache_Entry::suspend_timeout()</a>, <a class="el" href="transcode_8cc_source.html#l00064">thread_exit</a>, <a class="el" href="transcode_8cc_source.html#l00156">transcode_finish()</a>, <a class="el" href="cache__entry_8cc_source.html#l00146">Cache_Entry::update_access()</a>, <a class="el" href="ffmpeg__transcoder_8cc_source.html#l06169">FFmpeg_Transcoder::video_frame_count()</a>, <a class="el" href="cache__entry_8cc_source.html#l00321">Cache_Entry::virtname()</a>, and <a class="el" href="cache__entry_8cc_source.html#l00420">Cache_Entry::virtualfile()</a>.</p>

<p class="reference">Referenced by <a class="el" href="transcode_8cc_source.html#l00999">transcoder_thread()</a>.</p>

</div>
</div>
<a id="a9829a0962abb0def61a28bef699fb859" name="a9829a0962abb0def61a28bef699fb859"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9829a0962abb0def61a28bef699fb859">&#9670;&nbsp;</a></span>transcode_finish()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int transcode_finish </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classCache__Entry.html">Cache_Entry</a> *&#160;</td>
          <td class="paramname"><em>cache_entry</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classFFmpeg__Transcoder.html">FFmpeg_Transcoder</a> &amp;&#160;</td>
          <td class="paramname"><em>transcoder</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Close the input file and free everything but the initial buffer. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">cache_entry</td><td>- corresponding cache entry </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">transcoder</td><td>- Current <a class="el" href="classFFmpeg__Transcoder.html" title="The FFmpeg_Transcoder class.">FFmpeg_Transcoder</a> object. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>On success, returns 0; on error, a negative AVERROR value. </dd></dl>

<p class="definition">Definition at line <a class="el" href="transcode_8cc_source.html#l00156">156</a> of file <a class="el" href="transcode_8cc_source.html">transcode.cc</a>.</p>

<p class="reference">References <a class="el" href="logging_8h_source.html#l00182">Logging::debug()</a>, <a class="el" href="ffmpeg__transcoder_8cc_source.html#l06159">FFmpeg_Transcoder::duration()</a>, <a class="el" href="ffmpeg__transcoder_8cc_source.html#l06179">FFmpeg_Transcoder::encode_finish()</a>, <a class="el" href="cache_8h.html#a4a32a646521d02ddc7897ffabe261429a677faa2b5f198d066c6e6586f7719a80">FINISHED_INCOMPLETE</a>, <a class="el" href="cache_8h.html#a4a32a646521d02ddc7897ffabe261429ad98329da71a28c7b7b7dd89fe4909c40">FINISHED_SUCCESS</a>, <a class="el" href="cache__entry_8cc_source.html#l00246">Cache_Entry::flush()</a>, <a class="el" href="ffmpeg__utils_8cc_source.html#l01689">format_result_size_ex()</a>, <a class="el" href="ffmpeg__utils_8cc_source.html#l01669">format_size_ex()</a>, <a class="el" href="ffmpeg__transcoder_8cc_source.html#l06802">FFmpeg_Transcoder::have_seeked()</a>, <a class="el" href="ffmpeg__transcoder_8cc_source.html#l06765">FFmpeg_Transcoder::is_multiformat()</a>, <a class="el" href="cache_8h_source.html#l00089">CACHE_INFO::m_averror</a>, <a class="el" href="cache__entry_8h_source.html#l00271">Cache_Entry::m_buffer</a>, <a class="el" href="cache__entry_8h_source.html#l00277">Cache_Entry::m_cache_info</a>, <a class="el" href="cache_8h_source.html#l00081">CACHE_INFO::m_duration</a>, <a class="el" href="cache_8h_source.html#l00083">CACHE_INFO::m_encoded_filesize</a>, <a class="el" href="cache_8h_source.html#l00088">CACHE_INFO::m_errno</a>, <a class="el" href="cache__entry_8h_source.html#l00272">Cache_Entry::m_is_decoding</a>, <a class="el" href="cache_8h_source.html#l00082">CACHE_INFO::m_predicted_filesize</a>, <a class="el" href="cache_8h_source.html#l00086">CACHE_INFO::m_result</a>, <a class="el" href="cache_8h_source.html#l00085">CACHE_INFO::m_segment_count</a>, <a class="el" href="cache_8h_source.html#l00084">CACHE_INFO::m_video_frame_count</a>, <a class="el" href="ffmpeg__transcoder_8cc_source.html#l06174">FFmpeg_Transcoder::segment_count()</a>, <a class="el" href="ffmpeg__transcoder_8cc_source.html#l06169">FFmpeg_Transcoder::video_frame_count()</a>, and <a class="el" href="ffmpeg__transcoder_8cc_source.html#l06507">FFmpeg_Transcoder::virtname()</a>.</p>

<p class="reference">Referenced by <a class="el" href="transcode_8cc_source.html#l00775">transcode()</a>.</p>

</div>
</div>
<a id="a081aa7e4eb108b9ce0150cee5f5d4fe4" name="a081aa7e4eb108b9ce0150cee5f5d4fe4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a081aa7e4eb108b9ce0150cee5f5d4fe4">&#9670;&nbsp;</a></span>transcode_until()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static bool transcode_until </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classCache__Entry.html">Cache_Entry</a> *&#160;</td>
          <td class="paramname"><em>cache_entry</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>offset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>segment_no</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Transcode the buffer until the buffer has enough or until an error occurs. The buffer needs at least 'end' bytes before transcoding stops. Returns true if no errors and false otherwise. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">cache_entry</td><td>- corresponding cache entry </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">offset</td><td>- byte offset to start reading at </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">len</td><td>- length of data chunk to be read. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">segment_no</td><td>- HLS segment file number. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>On success, returns true. Returns false if an error occurred. </dd></dl>

<p class="definition">Definition at line <a class="el" href="transcode_8cc_source.html#l00081">81</a> of file <a class="el" href="transcode_8cc_source.html">transcode.cc</a>.</p>

<p class="reference">References <a class="el" href="logging_8h_source.html#l00201">Logging::info()</a>, <a class="el" href="cache__entry_8cc_source.html#l00435">Cache_Entry::is_finished()</a>, <a class="el" href="cache__entry_8h_source.html#l00271">Cache_Entry::m_buffer</a>, <a class="el" href="cache__entry_8h_source.html#l00277">Cache_Entry::m_cache_info</a>, <a class="el" href="cache_8h_source.html#l00087">CACHE_INFO::m_error</a>, <a class="el" href="cache__entry_8h_source.html#l00272">Cache_Entry::m_is_decoding</a>, <a class="el" href="ffmpeg__utils_8cc_source.html#l02535">mssleep()</a>, <a class="el" href="transcode_8cc_source.html#l00064">thread_exit</a>, <a class="el" href="logging_8h_source.html#l00163">Logging::trace()</a>, <a class="el" href="cache__entry_8cc_source.html#l00321">Cache_Entry::virtname()</a>, and <a class="el" href="logging_8h_source.html#l00220">Logging::warning()</a>.</p>

</div>
</div>
<a id="a82aa9ff8545f292b3236f9de19f4c65d" name="a82aa9ff8545f292b3236f9de19f4c65d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a82aa9ff8545f292b3236f9de19f4c65d">&#9670;&nbsp;</a></span>transcoder_buffer_tell()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">size_t transcoder_buffer_tell </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classCache__Entry.html">Cache_Entry</a> *&#160;</td>
          <td class="paramname"><em>cache_entry</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>segment_no</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Return the current file position in the file. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">cache_entry</td><td>- corresponding cache entry </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">segment_no</td><td>- HLS segment file number. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Returns the current file position </dd></dl>

<p class="definition">Definition at line <a class="el" href="transcode_8cc_source.html#l00733">733</a> of file <a class="el" href="transcode_8cc_source.html">transcode.cc</a>.</p>

<p class="reference">References <a class="el" href="cache__entry_8h_source.html#l00271">Cache_Entry::m_buffer</a>.</p>

</div>
</div>
<a id="ad7868030f5aead82e78204b1b4c6e8ba" name="ad7868030f5aead82e78204b1b4c6e8ba"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad7868030f5aead82e78204b1b4c6e8ba">&#9670;&nbsp;</a></span>transcoder_buffer_watermark()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">size_t transcoder_buffer_watermark </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classCache__Entry.html">Cache_Entry</a> *&#160;</td>
          <td class="paramname"><em>cache_entry</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>segment_no</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Return the current watermark of the file while transcoding. </p>
<p >While transcoding, this value reflects the current size of the transcoded file. This is the maximum byte offset until the file can be read so far.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">cache_entry</td><td>- corresponding cache entry </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">segment_no</td><td>- HLS segment file number. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Returns the current watermark </dd></dl>

<p class="definition">Definition at line <a class="el" href="transcode_8cc_source.html#l00728">728</a> of file <a class="el" href="transcode_8cc_source.html">transcode.cc</a>.</p>

<p class="reference">References <a class="el" href="cache__entry_8h_source.html#l00271">Cache_Entry::m_buffer</a>.</p>

<p class="reference">Referenced by <a class="el" href="fuseops_8cc_source.html#l00860">ffmpegfs_fgetattr()</a>.</p>

</div>
</div>
<a id="ae63249b0134b3b6bc8524fd809c46319" name="ae63249b0134b3b6bc8524fd809c46319"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae63249b0134b3b6bc8524fd809c46319">&#9670;&nbsp;</a></span>transcoder_cache_clear()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool transcoder_cache_clear </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Clear transcoder cache. </p>
<dl class="section return"><dt>Returns</dt><dd>Returns true on success; false on error. Check errno for details. </dd></dl>

<p class="definition">Definition at line <a class="el" href="transcode_8cc_source.html#l00755">755</a> of file <a class="el" href="transcode_8cc_source.html">transcode.cc</a>.</p>

<p class="reference">References <a class="el" href="transcode_8cc_source.html#l00063">cache</a>.</p>

</div>
</div>
<a id="aebae3dec0e78bdcd14cc4721f5b6efeb" name="aebae3dec0e78bdcd14cc4721f5b6efeb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aebae3dec0e78bdcd14cc4721f5b6efeb">&#9670;&nbsp;</a></span>transcoder_cache_maintenance()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool transcoder_cache_maintenance </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Run cache maintenance. </p>
<dl class="section return"><dt>Returns</dt><dd>Returns true on success; false on error. Check errno for details. </dd></dl>

<p class="definition">Definition at line <a class="el" href="transcode_8cc_source.html#l00743">743</a> of file <a class="el" href="transcode_8cc_source.html">transcode.cc</a>.</p>

<p class="reference">References <a class="el" href="transcode_8cc_source.html#l00063">cache</a>.</p>

<p class="reference">Referenced by <a class="el" href="ffmpegfs_8cc_source.html#l02349">main()</a>, and <a class="el" href="cache__maintenance_8cc_source.html#l00067">maintenance_handler()</a>.</p>

</div>
</div>
<a id="a3cd7e2e6abc840f21c8957f2f24425b3" name="a3cd7e2e6abc840f21c8957f2f24425b3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3cd7e2e6abc840f21c8957f2f24425b3">&#9670;&nbsp;</a></span>transcoder_cache_path()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void transcoder_cache_path </td>
          <td>(</td>
          <td class="paramtype">std::string *&#160;</td>
          <td class="paramname"><em>path</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get transcoder cache path. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">path</td><td>- Path to transcoder cache. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="transcode_8cc_source.html#l00195">195</a> of file <a class="el" href="transcode_8cc_source.html">transcode.cc</a>.</p>

<p class="reference">References <a class="el" href="ffmpeg__utils_8cc_source.html#l00983">append_sep()</a>, <a class="el" href="ffmpeg__utils_8cc_source.html#l01874">expand_path()</a>, <a class="el" href="ffmpegfs_8h_source.html#l00249">FFMPEGFS_PARAMS::m_cachepath</a>, and <a class="el" href="ffmpegfs_8cc_source.html#l00074">params</a>.</p>

<p class="reference">Referenced by <a class="el" href="cache_8cc_source.html#l00611">Cache::load_index()</a>, <a class="el" href="buffer_8cc_source.html#l00975">Buffer::make_cachefile_name()</a>, <a class="el" href="ffmpegfs_8cc_source.html#l02046">print_params()</a>, and <a class="el" href="logging_8cc_source.html#l00109">Logging::Logger::~Logger()</a>.</p>

</div>
</div>
<a id="aeaf746244e3f08933d0c1ed855915207" name="aeaf746244e3f08933d0c1ed855915207"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeaf746244e3f08933d0c1ed855915207">&#9670;&nbsp;</a></span>transcoder_cached_filesize()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool transcoder_cached_filesize </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="fileio_8h.html#ae8356f209b2b74cc385a8d7551f1f27a">LPVIRTUALFILE</a>&#160;</td>
          <td class="paramname"><em>virtualfile</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct stat *&#160;</td>
          <td class="paramname"><em>stbuf</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Simply get encoded file size (do not create the whole encoder/decoder objects) </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">virtualfile</td><td>- virtual file object to open </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">stbuf</td><td>- stat struct filled in with the size of the cached file </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Returns true if file was found in cache, false if not (stbuf will be unchanged) </dd></dl>

<p class="definition">Definition at line <a class="el" href="transcode_8cc_source.html#l00261">261</a> of file <a class="el" href="transcode_8cc_source.html">transcode.cc</a>.</p>

<p class="reference">References <a class="el" href="transcode_8cc_source.html#l00063">cache</a>, <a class="el" href="cache__entry_8h_source.html#l00277">Cache_Entry::m_cache_info</a>, <a class="el" href="cache_8h_source.html#l00083">CACHE_INFO::m_encoded_filesize</a>, <a class="el" href="cache_8h_source.html#l00082">CACHE_INFO::m_predicted_filesize</a>, and <a class="el" href="ffmpeg__utils_8cc_source.html#l02397">stat_set_size()</a>.</p>

<p class="reference">Referenced by <a class="el" href="blurayparser_8cc_source.html#l00432">create_bluray_virtualfile()</a>, <a class="el" href="cuesheetparser_8cc_source.html#l00119">create_cuesheet_virtualfile()</a>, <a class="el" href="dvdparser_8cc_source.html#l00242">create_dvd_virtualfile()</a>, and <a class="el" href="fuseops_8cc_source.html#l00542">ffmpegfs_getattr()</a>.</p>

</div>
</div>
<a id="afa40f1d11c536c0267ff99aa7f2900c6" name="afa40f1d11c536c0267ff99aa7f2900c6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afa40f1d11c536c0267ff99aa7f2900c6">&#9670;&nbsp;</a></span>transcoder_delete()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void transcoder_delete </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classCache__Entry.html">Cache_Entry</a> *&#160;</td>
          <td class="paramname"><em>cache_entry</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Free the cache entry structure. </p>
<p >Call this to free the cache entry structure. <br  />
The structure is reference counted, after calling this function, if the cache entry is not use by another thread, the cache entry may no longer be valid.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">cache_entry</td><td>- corresponding cache entry </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="transcode_8cc_source.html#l00718">718</a> of file <a class="el" href="transcode_8cc_source.html">transcode.cc</a>.</p>

<p class="reference">References <a class="el" href="transcode_8cc_source.html#l00063">cache</a>.</p>

<p class="reference">Referenced by <a class="el" href="fuseops_8cc_source.html#l00542">ffmpegfs_getattr()</a>, <a class="el" href="fuseops_8cc_source.html#l01302">ffmpegfs_release()</a>, <a class="el" href="fuseops_8cc_source.html#l01412">get_source_properties()</a>, and <a class="el" href="fuseops_8cc_source.html#l02156">kick_next()</a>.</p>

</div>
</div>
<a id="aa523c3a9437882cd71e010577aab8249" name="aa523c3a9437882cd71e010577aab8249"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa523c3a9437882cd71e010577aab8249">&#9670;&nbsp;</a></span>transcoder_exit()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void transcoder_exit </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Exit transcoding. </p>
<p >Send signal to exit transcoding (ending all transcoder threads). </p>

<p class="definition">Definition at line <a class="el" href="transcode_8cc_source.html#l00738">738</a> of file <a class="el" href="transcode_8cc_source.html">transcode.cc</a>.</p>

<p class="reference">References <a class="el" href="transcode_8cc_source.html#l00064">thread_exit</a>.</p>

<p class="reference">Referenced by <a class="el" href="fuseops_8cc_source.html#l01385">ffmpegfs_destroy()</a>, and <a class="el" href="fuseops_8cc_source.html#l02194">sighandler()</a>.</p>

</div>
</div>
<a id="a7b9eeffdb94ced039971a18ef11779c5" name="a7b9eeffdb94ced039971a18ef11779c5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7b9eeffdb94ced039971a18ef11779c5">&#9670;&nbsp;</a></span>transcoder_free()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void transcoder_free </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Free transcoder. </p>

<p class="definition">Definition at line <a class="el" href="transcode_8cc_source.html#l00251">251</a> of file <a class="el" href="transcode_8cc_source.html">transcode.cc</a>.</p>

<p class="reference">References <a class="el" href="transcode_8cc_source.html#l00063">cache</a>, and <a class="el" href="logging_8h_source.html#l00182">Logging::debug()</a>.</p>

<p class="reference">Referenced by <a class="el" href="fuseops_8cc_source.html#l01385">ffmpegfs_destroy()</a>.</p>

</div>
</div>
<a id="aa5d36e6c898b599099ee24f3bc6b7585" name="aa5d36e6c898b599099ee24f3bc6b7585"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa5d36e6c898b599099ee24f3bc6b7585">&#9670;&nbsp;</a></span>transcoder_get_size()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">size_t transcoder_get_size </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classCache__Entry.html">Cache_Entry</a> *&#160;</td>
          <td class="paramname"><em>cache_entry</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Return size of output file, as computed by encoder. </p>
<p >Returns the file size, either the predicted size (which may be inaccurate) or the real size (which is only available once the file was completely recoded).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">cache_entry</td><td>- corresponding cache entry </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The size of the file. Function never fails. </dd></dl>

<p class="definition">Definition at line <a class="el" href="transcode_8cc_source.html#l00723">723</a> of file <a class="el" href="transcode_8cc_source.html">transcode.cc</a>.</p>

<p class="reference">References <a class="el" href="cache__entry_8cc_source.html#l00260">Cache_Entry::size()</a>.</p>

<p class="reference">Referenced by <a class="el" href="fuseops_8cc_source.html#l00542">ffmpegfs_getattr()</a>.</p>

</div>
</div>
<a id="ab94b13295817a6faab86611c4ed5afc1" name="ab94b13295817a6faab86611c4ed5afc1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab94b13295817a6faab86611c4ed5afc1">&#9670;&nbsp;</a></span>transcoder_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool transcoder_init </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialise transcoder, create cache. </p>
<dl class="section return"><dt>Returns</dt><dd>Returns true on success; false on error. Check errno for details. </dd></dl>

<p class="definition">Definition at line <a class="el" href="transcode_8cc_source.html#l00229">229</a> of file <a class="el" href="transcode_8cc_source.html">transcode.cc</a>.</p>

<p class="reference">References <a class="el" href="transcode_8cc_source.html#l00063">cache</a>, <a class="el" href="logging_8h_source.html#l00182">Logging::debug()</a>, and <a class="el" href="logging_8h_source.html#l00239">Logging::error()</a>.</p>

<p class="reference">Referenced by <a class="el" href="ffmpegfs_8cc_source.html#l02349">main()</a>.</p>

</div>
</div>
<a id="a473016e27c83fb4113497baab16ff574" name="a473016e27c83fb4113497baab16ff574"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a473016e27c83fb4113497baab16ff574">&#9670;&nbsp;</a></span>transcoder_new()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classCache__Entry.html">Cache_Entry</a> * transcoder_new </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="fileio_8h.html#ae8356f209b2b74cc385a8d7551f1f27a">LPVIRTUALFILE</a>&#160;</td>
          <td class="paramname"><em>virtualfile</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>begin_transcode</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Allocate and initialise the transcoder. </p>
<p >Opens a file and starts the decoding thread if begin_transcode is true. File will be scanned to detect bit rate, duration etc. only if begin_transcode is false.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">virtualfile</td><td>- virtual file object to open </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">begin_transcode</td><td>- if true, transcoding starts, if false file will be scanned only </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>On success, returns cache entry object. On error, returns nullptr and sets errno accordingly. </dd></dl>

<p class="definition">Definition at line <a class="el" href="transcode_8cc_source.html#l00353">353</a> of file <a class="el" href="transcode_8cc_source.html">transcode.cc</a>.</p>

<p class="reference">References <a class="el" href="transcode_8cc_source.html#l00063">cache</a>, <a class="el" href="buffer_8h_source.html#l00047">CACHE_CLOSE_DELETE</a>, <a class="el" href="cache__entry_8cc_source.html#l00085">Cache_Entry::clear()</a>, <a class="el" href="logging_8h_source.html#l00182">Logging::debug()</a>, <a class="el" href="cache__entry_8cc_source.html#l00311">Cache_Entry::filename()</a>, <a class="el" href="cache__entry_8cc_source.html#l00445">Cache_Entry::is_finished_success()</a>, <a class="el" href="cache__entry_8cc_source.html#l00326">Cache_Entry::lock()</a>, <a class="el" href="cache__entry_8h_source.html#l00277">Cache_Entry::m_cache_info</a>, <a class="el" href="ffmpegfs_8h_source.html#l00250">FFMPEGFS_PARAMS::m_disable_cache</a>, <a class="el" href="cache_8h_source.html#l00081">CACHE_INFO::m_duration</a>, <a class="el" href="fileio_8h_source.html#l00156">VIRTUALFILE::m_duration</a>, <a class="el" href="cache_8h_source.html#l00088">CACHE_INFO::m_errno</a>, <a class="el" href="cache_8h_source.html#l00087">CACHE_INFO::m_error</a>, <a class="el" href="cache__entry_8h_source.html#l00272">Cache_Entry::m_is_decoding</a>, <a class="el" href="cache_8h_source.html#l00082">CACHE_INFO::m_predicted_filesize</a>, <a class="el" href="fileio_8h_source.html#l00157">VIRTUALFILE::m_predicted_size</a>, <a class="el" href="cache_8h_source.html#l00084">CACHE_INFO::m_video_frame_count</a>, <a class="el" href="fileio_8h_source.html#l00158">VIRTUALFILE::m_video_frame_count</a>, <a class="el" href="cache__entry_8cc_source.html#l00160">Cache_Entry::openio()</a>, <a class="el" href="cache__entry_8cc_source.html#l00351">Cache_Entry::outdated()</a>, <a class="el" href="ffmpegfs_8cc_source.html#l00074">params</a>, <a class="el" href="fuseops_8cc_source.html#l00102">tp</a>, <a class="el" href="logging_8h_source.html#l00163">Logging::trace()</a>, <a class="el" href="transcode_8cc_source.html#l00328">transcoder_predict_filesize()</a>, <a class="el" href="transcode_8cc_source.html#l00999">transcoder_thread()</a>, <a class="el" href="cache__entry_8cc_source.html#l00331">Cache_Entry::unlock()</a>, and <a class="el" href="cache__entry_8cc_source.html#l00321">Cache_Entry::virtname()</a>.</p>

<p class="reference">Referenced by <a class="el" href="fuseops_8cc_source.html#l00542">ffmpegfs_getattr()</a>, <a class="el" href="fuseops_8cc_source.html#l00971">ffmpegfs_open()</a>, <a class="el" href="fuseops_8cc_source.html#l01412">get_source_properties()</a>, and <a class="el" href="fuseops_8cc_source.html#l02156">kick_next()</a>.</p>

</div>
</div>
<a id="a318fb7fd8dac4f1ab7b350972962b89f" name="a318fb7fd8dac4f1ab7b350972962b89f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a318fb7fd8dac4f1ab7b350972962b89f">&#9670;&nbsp;</a></span>transcoder_predict_filesize()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool transcoder_predict_filesize </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="fileio_8h.html#ae8356f209b2b74cc385a8d7551f1f27a">LPVIRTUALFILE</a>&#160;</td>
          <td class="paramname"><em>virtualfile</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classCache__Entry.html">Cache_Entry</a> *&#160;</td>
          <td class="paramname"><em>cache_entry</em> = <code>nullptr</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Predict file size. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">virtualfile</td><td>- virtual file object to open </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">cache_entry</td><td>- corresponding cache entry </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>On error, returns false (size could not be predicted) or true on success </dd></dl>

<p class="definition">Definition at line <a class="el" href="transcode_8cc_source.html#l00328">328</a> of file <a class="el" href="transcode_8cc_source.html">transcode.cc</a>.</p>

<p class="reference">References <a class="el" href="ffmpeg__transcoder_8cc_source.html#l06476">FFmpeg_Transcoder::closeio()</a>, <a class="el" href="ffmpeg__transcoder_8cc_source.html#l06159">FFmpeg_Transcoder::duration()</a>, <a class="el" href="ffmpeg__transcoder_8cc_source.html#l06497">FFmpeg_Transcoder::filename()</a>, <a class="el" href="ffmpeg__utils_8cc_source.html#l01669">format_size_ex()</a>, <a class="el" href="cache__entry_8h_source.html#l00277">Cache_Entry::m_cache_info</a>, <a class="el" href="cache_8h_source.html#l00081">CACHE_INFO::m_duration</a>, <a class="el" href="cache_8h_source.html#l00082">CACHE_INFO::m_predicted_filesize</a>, <a class="el" href="cache_8h_source.html#l00085">CACHE_INFO::m_segment_count</a>, <a class="el" href="cache_8h_source.html#l00084">CACHE_INFO::m_video_frame_count</a>, <a class="el" href="ffmpeg__transcoder_8cc_source.html#l00294">FFmpeg_Transcoder::open_input_file()</a>, <a class="el" href="ffmpeg__transcoder_8cc_source.html#l06164">FFmpeg_Transcoder::predicted_filesize()</a>, <a class="el" href="ffmpeg__transcoder_8cc_source.html#l06174">FFmpeg_Transcoder::segment_count()</a>, <a class="el" href="logging_8h_source.html#l00163">Logging::trace()</a>, and <a class="el" href="ffmpeg__transcoder_8cc_source.html#l06169">FFmpeg_Transcoder::video_frame_count()</a>.</p>

<p class="reference">Referenced by <a class="el" href="transcode_8cc_source.html#l00353">transcoder_new()</a>.</p>

</div>
</div>
<a id="a8f7737e72a5cd08de149c65bbafd7fe7" name="a8f7737e72a5cd08de149c65bbafd7fe7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8f7737e72a5cd08de149c65bbafd7fe7">&#9670;&nbsp;</a></span>transcoder_read()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool transcoder_read </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classCache__Entry.html">Cache_Entry</a> *&#160;</td>
          <td class="paramname"><em>cache_entry</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>buff</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>offset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>bytes_read</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>segment_no</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Read some bytes from the internal buffer and into the given buffer. </p>
<dl class="section note"><dt>Note</dt><dd>buff must be large enough to hold len number of bytes. </dd>
<dd>
Returns number of bytes read, may be less than len bytes. </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">cache_entry</td><td>- corresponding cache entry </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">buff</td><td>- will be filled in with data read </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">offset</td><td>- byte offset to start reading at </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">len</td><td>- length of data chunk to be read. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">bytes_read</td><td>- Bytes read from transcoder. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">segment_no</td><td>- HLS segment file number. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>On success, returns true. On error, returns false and sets errno accordingly. </dd></dl>

<p class="definition">Definition at line <a class="el" href="transcode_8cc_source.html#l00469">469</a> of file <a class="el" href="transcode_8cc_source.html">transcode.cc</a>.</p>

<p class="reference">References <a class="el" href="buffer_8h_source.html#l00049">CACHE_FLAG_RO</a>, <a class="el" href="ffmpegfs_8cc_source.html#l00235">FFMPEGFS_PARAMS::current_format()</a>, <a class="el" href="ffmpeg__utils_8cc_source.html#l00908">FFmpegfs_Format::filetype()</a>, <a class="el" href="cache__entry_8cc_source.html#l00445">Cache_Entry::is_finished_success()</a>, <a class="el" href="cache__entry_8h_source.html#l00271">Cache_Entry::m_buffer</a>, <a class="el" href="cache__entry_8h_source.html#l00281">Cache_Entry::m_seek_to_no</a>, <a class="el" href="ffmpegfs_8cc_source.html#l00074">params</a>, <a class="el" href="logging_8h_source.html#l00163">Logging::trace()</a>, <a class="el" href="cache__entry_8cc_source.html#l00146">Cache_Entry::update_access()</a>, <a class="el" href="cache__entry_8cc_source.html#l00425">Cache_Entry::update_read_count()</a>, <a class="el" href="cache__entry_8cc_source.html#l00321">Cache_Entry::virtname()</a>, and <a class="el" href="cache__entry_8cc_source.html#l00420">Cache_Entry::virtualfile()</a>.</p>

<p class="reference">Referenced by <a class="el" href="fuseops_8cc_source.html#l01090">ffmpegfs_read()</a>.</p>

</div>
</div>
<a id="aaa23ed05d04f3180fa5622f41fe5f702" name="aaa23ed05d04f3180fa5622f41fe5f702"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaa23ed05d04f3180fa5622f41fe5f702">&#9670;&nbsp;</a></span>transcoder_read_frame()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool transcoder_read_frame </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classCache__Entry.html">Cache_Entry</a> *&#160;</td>
          <td class="paramname"><em>cache_entry</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>buff</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>offset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>frame_no</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>bytes_read</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="fileio_8h.html#ae8356f209b2b74cc385a8d7551f1f27a">LPVIRTUALFILE</a>&#160;</td>
          <td class="paramname"><em>virtualfile</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Read one image frame from the internal buffer and into the given buffer. </p>
<dl class="section note"><dt>Note</dt><dd>buff must be large enough to hold len number of bytes. </dd>
<dd>
Returns number of bytes read, may be less than len bytes. </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">cache_entry</td><td>- corresponding cache entry </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">buff</td><td>- will be filled in with data read </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">offset</td><td>- byte offset to start reading at </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">len</td><td>- length of data chunk to be read. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">frame_no</td><td>- Number of frame to return. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">bytes_read</td><td>- Bytes read from transcoder. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">virtualfile</td><td>- Birtual file object of image, may be modified. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>On success, returns true. On error, returns false and sets errno accordingly. </dd></dl>

<p class="definition">Definition at line <a class="el" href="transcode_8cc_source.html#l00603">603</a> of file <a class="el" href="transcode_8cc_source.html">transcode.cc</a>.</p>

<p class="reference">References <a class="el" href="buffer_8h_source.html#l00049">CACHE_FLAG_RO</a>, <a class="el" href="logging_8h_source.html#l00239">Logging::error()</a>, <a class="el" href="transcode_8cc_source.html#l00048">GRANULARITY</a>, <a class="el" href="cache__entry_8h_source.html#l00271">Cache_Entry::m_buffer</a>, <a class="el" href="cache__entry_8h_source.html#l00277">Cache_Entry::m_cache_info</a>, <a class="el" href="cache_8h_source.html#l00087">CACHE_INFO::m_error</a>, <a class="el" href="cache__entry_8h_source.html#l00272">Cache_Entry::m_is_decoding</a>, <a class="el" href="cache__entry_8h_source.html#l00281">Cache_Entry::m_seek_to_no</a>, <a class="el" href="fileio_8h_source.html#l00153">VIRTUALFILE::m_st</a>, <a class="el" href="cache__entry_8h_source.html#l00275">Cache_Entry::m_suspend_timeout</a>, <a class="el" href="ffmpeg__utils_8cc_source.html#l02535">mssleep()</a>, <a class="el" href="ffmpeg__utils_8cc_source.html#l02397">stat_set_size()</a>, <a class="el" href="transcode_8cc_source.html#l00064">thread_exit</a>, <a class="el" href="transcode_8cc_source.html#l00050">TOTAL_RETRIES</a>, <a class="el" href="logging_8h_source.html#l00163">Logging::trace()</a>, <a class="el" href="cache__entry_8cc_source.html#l00146">Cache_Entry::update_access()</a>, <a class="el" href="cache__entry_8cc_source.html#l00425">Cache_Entry::update_read_count()</a>, <a class="el" href="cache__entry_8cc_source.html#l00321">Cache_Entry::virtname()</a>, and <a class="el" href="logging_8h_source.html#l00220">Logging::warning()</a>.</p>

<p class="reference">Referenced by <a class="el" href="fuseops_8cc_source.html#l01090">ffmpegfs_read()</a>.</p>

</div>
</div>
<a id="a4b4a6f7de7c8e817105ab07d331936a8" name="a4b4a6f7de7c8e817105ab07d331936a8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4b4a6f7de7c8e817105ab07d331936a8">&#9670;&nbsp;</a></span>transcoder_set_filesize()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool transcoder_set_filesize </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="fileio_8h.html#ae8356f209b2b74cc385a8d7551f1f27a">LPVIRTUALFILE</a>&#160;</td>
          <td class="paramname"><em>virtualfile</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int64_t&#160;</td>
          <td class="paramname"><em>duration</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ffmpeg__utils_8h.html#a17468d10f0c67a4ee7b38aab09d9e096">BITRATE</a>&#160;</td>
          <td class="paramname"><em>audio_bit_rate</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>channels</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>sample_rate</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">AVSampleFormat&#160;</td>
          <td class="paramname"><em>sample_format</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ffmpeg__utils_8h.html#a17468d10f0c67a4ee7b38aab09d9e096">BITRATE</a>&#160;</td>
          <td class="paramname"><em>video_bit_rate</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>width</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>height</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>interleaved</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const AVRational &amp;&#160;</td>
          <td class="paramname"><em>framerate</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set the file size. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">virtualfile</td><td>- virtual file object to open. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">duration</td><td>- duration of the file, in AV_TIME_BASE fractional seconds. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">audio_bit_rate</td><td>- average bitrate of audio data (in bits per second). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">channels</td><td>- number of channels (1: mono, 2: stereo, or more). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">sample_rate</td><td>- number of audio samples per second. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">sample_format</td><td>- Selected sample format </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">video_bit_rate</td><td>- average bitrate of video data (in bits per second). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">width</td><td>- video width in pixels. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">height</td><td>- video height in pixels. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">interleaved</td><td>- true if video is interleaved, false if not. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">framerate</td><td>- frame rate per second (e.g. 24, 25, 30...). </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>On error, returns false (size could not be set) or true on success. </dd></dl>

<p class="definition">Definition at line <a class="el" href="transcode_8cc_source.html#l00288">288</a> of file <a class="el" href="transcode_8cc_source.html">transcode.cc</a>.</p>

<p class="reference">References <a class="el" href="ffmpeg__utils_8cc_source.html#l00948">FFmpegfs_Format::audio_codec()</a>, <a class="el" href="ffmpeg__transcoder_8cc_source.html#l05734">FFmpeg_Transcoder::audio_size()</a>, <a class="el" href="transcode_8cc_source.html#l00063">cache</a>, <a class="el" href="ffmpegfs_8cc_source.html#l00235">FFMPEGFS_PARAMS::current_format()</a>, <a class="el" href="ffmpeg__utils_8cc_source.html#l00893">FFmpegfs_Format::desttype()</a>, <a class="el" href="logging_8h_source.html#l00239">Logging::error()</a>, <a class="el" href="ffmpeg__utils_8cc_source.html#l00908">FFmpegfs_Format::filetype()</a>, <a class="el" href="ffmpeg__utils_8cc_source.html#l01669">format_size_ex()</a>, <a class="el" href="ffmpeg__utils_8cc_source.html#l01353">get_codec_name()</a>, <a class="el" href="ffmpeg__utils_8cc_source.html#l01454">get_filetype_text()</a>, <a class="el" href="cache__entry_8h_source.html#l00277">Cache_Entry::m_cache_info</a>, <a class="el" href="cache_8h_source.html#l00082">CACHE_INFO::m_predicted_filesize</a>, <a class="el" href="fileio_8h_source.html#l00157">VIRTUALFILE::m_predicted_size</a>, <a class="el" href="ffmpegfs_8cc_source.html#l00074">params</a>, <a class="el" href="ffmpeg__transcoder_8cc_source.html#l06010">FFmpeg_Transcoder::total_overhead()</a>, <a class="el" href="logging_8h_source.html#l00163">Logging::trace()</a>, <a class="el" href="ffmpeg__utils_8cc_source.html#l00933">FFmpegfs_Format::video_codec()</a>, <a class="el" href="ffmpeg__transcoder_8cc_source.html#l05926">FFmpeg_Transcoder::video_size()</a>, <a class="el" href="cache__entry_8cc_source.html#l00321">Cache_Entry::virtname()</a>, and <a class="el" href="logging_8h_source.html#l00220">Logging::warning()</a>.</p>

<p class="reference">Referenced by <a class="el" href="blurayparser_8cc_source.html#l00432">create_bluray_virtualfile()</a>, <a class="el" href="cuesheetparser_8cc_source.html#l00119">create_cuesheet_virtualfile()</a>, and <a class="el" href="dvdparser_8cc_source.html#l00242">create_dvd_virtualfile()</a>.</p>

</div>
</div>
<a id="ae6ac280210471b832da4e4661d5d9209" name="ae6ac280210471b832da4e4661d5d9209"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae6ac280210471b832da4e4661d5d9209">&#9670;&nbsp;</a></span>transcoder_thread()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int transcoder_thread </td>
          <td>(</td>
          <td class="paramtype">std::shared_ptr&lt; <a class="el" href="structTHREAD__DATA.html">THREAD_DATA</a> &gt;&#160;</td>
          <td class="paramname"><em>thread_data</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Transcoding thread. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">thread_data</td><td>- Corresponding thread data object. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Returns 0 on success; or errno code on error. </dd></dl>

<p class="definition">Definition at line <a class="el" href="transcode_8cc_source.html#l00999">999</a> of file <a class="el" href="transcode_8cc_source.html">transcode.cc</a>.</p>

<p class="reference">References <a class="el" href="transcode_8cc_source.html#l00063">cache</a>, <a class="el" href="buffer_8h_source.html#l00047">CACHE_CLOSE_DELETE</a>, <a class="el" href="buffer_8h_source.html#l00045">CACHE_CLOSE_NOOPT</a>, <a class="el" href="logging_8h_source.html#l00239">Logging::error()</a>, <a class="el" href="ffmpeg__utils_8cc_source.html#l01137">ffmpeg_geterror()</a>, <a class="el" href="ffmpeg__transcoder_8cc_source.html#l06802">FFmpeg_Transcoder::have_seeked()</a>, <a class="el" href="logging_8h_source.html#l00201">Logging::info()</a>, <a class="el" href="ffmpeg__transcoder_8cc_source.html#l07851">FFmpeg_Transcoder::last_seek_frame_no()</a>, <a class="el" href="cache__entry_8h_source.html#l00273">Cache_Entry::m_active_mutex</a>, <a class="el" href="cache_8h_source.html#l00089">CACHE_INFO::m_averror</a>, <a class="el" href="cache__entry_8h_source.html#l00277">Cache_Entry::m_cache_info</a>, <a class="el" href="cache_8h_source.html#l00088">CACHE_INFO::m_errno</a>, <a class="el" href="cache_8h_source.html#l00087">CACHE_INFO::m_error</a>, <a class="el" href="cache__entry_8h_source.html#l00272">Cache_Entry::m_is_decoding</a>, <a class="el" href="ffmpegfs_8h_source.html#l00244">FFMPEGFS_PARAMS::m_max_inactive_abort</a>, <a class="el" href="cache__entry_8h_source.html#l00274">Cache_Entry::m_restart_mutex</a>, <a class="el" href="cache__entry_8h_source.html#l00281">Cache_Entry::m_seek_to_no</a>, <a class="el" href="ffmpegfs_8cc_source.html#l00074">params</a>, <a class="el" href="transcode_8cc_source.html#l00064">thread_exit</a>, <a class="el" href="transcode_8cc_source.html#l00775">transcode()</a>, <a class="el" href="cache__entry_8cc_source.html#l00321">Cache_Entry::virtname()</a>, <a class="el" href="ffmpeg__transcoder_8cc_source.html#l06507">FFmpeg_Transcoder::virtname()</a>, and <a class="el" href="logging_8h_source.html#l00220">Logging::warning()</a>.</p>

<p class="reference">Referenced by <a class="el" href="transcode_8cc_source.html#l00353">transcoder_new()</a>.</p>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a5461162a9673eae67fac6461f26feeaa" name="a5461162a9673eae67fac6461f26feeaa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5461162a9673eae67fac6461f26feeaa">&#9670;&nbsp;</a></span>cache</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::unique_ptr&lt;<a class="el" href="classCache.html">Cache</a>&gt; cache</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Global cache manager object. </p>

<p class="definition">Definition at line <a class="el" href="transcode_8cc_source.html#l00063">63</a> of file <a class="el" href="transcode_8cc_source.html">transcode.cc</a>.</p>

<p class="reference">Referenced by <a class="el" href="transcode_8cc_source.html#l00775">transcode()</a>, <a class="el" href="transcode_8cc_source.html#l00755">transcoder_cache_clear()</a>, <a class="el" href="transcode_8cc_source.html#l00743">transcoder_cache_maintenance()</a>, <a class="el" href="transcode_8cc_source.html#l00261">transcoder_cached_filesize()</a>, <a class="el" href="transcode_8cc_source.html#l00718">transcoder_delete()</a>, <a class="el" href="transcode_8cc_source.html#l00251">transcoder_free()</a>, <a class="el" href="transcode_8cc_source.html#l00229">transcoder_init()</a>, <a class="el" href="transcode_8cc_source.html#l00353">transcoder_new()</a>, <a class="el" href="transcode_8cc_source.html#l00288">transcoder_set_filesize()</a>, and <a class="el" href="transcode_8cc_source.html#l00999">transcoder_thread()</a>.</p>

</div>
</div>
<a id="aece72d904a40c179fd108ddd5a3fd555" name="aece72d904a40c179fd108ddd5a3fd555"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aece72d904a40c179fd108ddd5a3fd555">&#9670;&nbsp;</a></span>FRAME_TIMEOUT</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const int FRAME_TIMEOUT = 60</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Image frame conversion: timout seconds to wait if a picture frame is available. </p>

<p class="definition">Definition at line <a class="el" href="transcode_8cc_source.html#l00049">49</a> of file <a class="el" href="transcode_8cc_source.html">transcode.cc</a>.</p>

</div>
</div>
<a id="a80b544d9fd59324f5124c9ae0d535941" name="a80b544d9fd59324f5124c9ae0d535941"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a80b544d9fd59324f5124c9ae0d535941">&#9670;&nbsp;</a></span>GRANULARITY</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const int GRANULARITY = 250</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Image frame conversion: ms between checks if a picture frame is available. </p>

<p class="definition">Definition at line <a class="el" href="transcode_8cc_source.html#l00048">48</a> of file <a class="el" href="transcode_8cc_source.html">transcode.cc</a>.</p>

<p class="reference">Referenced by <a class="el" href="transcode_8cc_source.html#l00775">transcode()</a>, and <a class="el" href="transcode_8cc_source.html#l00603">transcoder_read_frame()</a>.</p>

</div>
</div>
<a id="a36e64cbe664ab3b2b8ca1b823a895d23" name="a36e64cbe664ab3b2b8ca1b823a895d23"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a36e64cbe664ab3b2b8ca1b823a895d23">&#9670;&nbsp;</a></span>thread_exit</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::atomic_bool thread_exit</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Used for shutdown: if true, forcibly exit all threads. </p>

<p class="definition">Definition at line <a class="el" href="transcode_8cc_source.html#l00064">64</a> of file <a class="el" href="transcode_8cc_source.html">transcode.cc</a>.</p>

<p class="reference">Referenced by <a class="el" href="transcode_8cc_source.html#l00775">transcode()</a>, <a class="el" href="transcode_8cc_source.html#l00081">transcode_until()</a>, <a class="el" href="transcode_8cc_source.html#l00738">transcoder_exit()</a>, <a class="el" href="transcode_8cc_source.html#l00603">transcoder_read_frame()</a>, and <a class="el" href="transcode_8cc_source.html#l00999">transcoder_thread()</a>.</p>

</div>
</div>
<a id="a16b35c3c2fab1ce85fb27d3abed7797b" name="a16b35c3c2fab1ce85fb27d3abed7797b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a16b35c3c2fab1ce85fb27d3abed7797b">&#9670;&nbsp;</a></span>TOTAL_RETRIES</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const int TOTAL_RETRIES = <a class="el" href="transcode_8cc.html#aece72d904a40c179fd108ddd5a3fd555">FRAME_TIMEOUT</a>*1000/<a class="el" href="transcode_8cc.html#a80b544d9fd59324f5124c9ae0d535941">GRANULARITY</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Number of retries. </p>

<p class="definition">Definition at line <a class="el" href="transcode_8cc_source.html#l00050">50</a> of file <a class="el" href="transcode_8cc_source.html">transcode.cc</a>.</p>

<p class="reference">Referenced by <a class="el" href="transcode_8cc_source.html#l00603">transcoder_read_frame()</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.4
</small></address>
</body>
</html>
