<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>FFmpegfs Fuse Multi Media Filesystem: src/dvdparser.cc File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">FFmpegfs Fuse Multi Media Filesystem
   &#160;<span id="projectnumber">2.3</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">dvdparser.cc File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>dvdparser class implementation  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="ffmpegfs_8h_source.html">ffmpegfs.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="dvdparser_8h_source.html">dvdparser.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="transcode_8h_source.html">transcode.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="ffmpeg__utils_8h_source.html">ffmpeg_utils.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="logging_8h_source.html">logging.h</a>&quot;</code><br />
<code>#include &lt;dvdread/dvd_reader.h&gt;</code><br />
<code>#include &lt;dvdread/ifo_read.h&gt;</code><br />
<code>#include &lt;libavutil/rational.h&gt;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for dvdparser.cc:</div>
<div class="dyncontent">
<div class="center"><img src="dvdparser_8cc__incl.png" border="0" usemap="#asrc_2dvdparser_8cc" alt=""/></div>
<map name="asrc_2dvdparser_8cc" id="asrc_2dvdparser_8cc">
<area shape="rect" title="dvdparser class implementation" alt="" coords="739,5,867,32"/>
<area shape="rect" href="ffmpegfs_8h.html" title="Main include for FFmpegfs project." alt="" coords="639,155,732,181"/>
<area shape="rect" href="ffmpeg__utils_8h.html" title="Various FFmpegfs utility functions." alt="" coords="382,229,498,256"/>
<area shape="rect" href="dvdparser_8h.html" title="DVD parser." alt="" coords="495,155,593,181"/>
<area shape="rect" href="transcode_8h.html" title="File transcoder interface (for use with by FUSE)" alt="" coords="711,80,809,107"/>
<area shape="rect" href="logging_8h.html" title="Provide various log facilities to stderr, disk or syslog." alt="" coords="996,229,1079,256"/>
<area shape="rect" title=" " alt="" coords="885,80,1049,107"/>
<area shape="rect" title=" " alt="" coords="1073,80,1217,107"/>
<area shape="rect" title=" " alt="" coords="1241,80,1383,107"/>
<area shape="rect" title=" " alt="" coords="574,229,637,256"/>
<area shape="rect" title=" " alt="" coords="661,229,736,256"/>
<area shape="rect" href="fileio_8h.html" title="FileIO class." alt="" coords="760,229,827,256"/>
<area shape="rect" href="ffmpeg__compat_8h.html" title="FFmpeg API compatibility." alt="" coords="335,304,473,331"/>
<area shape="rect" title=" " alt="" coords="497,304,556,331"/>
<area shape="rect" title=" " alt="" coords="581,304,643,331"/>
<area shape="rect" title=" " alt="" coords="668,304,727,331"/>
<area shape="rect" title=" " alt="" coords="5,304,112,331"/>
<area shape="rect" title=" " alt="" coords="137,304,311,331"/>
<area shape="rect" title=" " alt="" coords="751,304,836,331"/>
<area shape="rect" title=" " alt="" coords="1012,304,1063,331"/>
<area shape="rect" title=" " alt="" coords="860,304,988,331"/>
<area shape="rect" title=" " alt="" coords="1087,304,1161,331"/>
<area shape="rect" title=" " alt="" coords="1185,304,1260,331"/>
</map>
</div>
</div>
<p><a href="dvdparser_8cc_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structAUDIO__SETTINGS.html">AUDIO_SETTINGS</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Audio stream settings.  <a href="structAUDIO__SETTINGS.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structVIDEO__SETTINGS.html">VIDEO_SETTINGS</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Video stream settings.  <a href="structVIDEO__SETTINGS.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:aab42e835e95b6eca7addbff679c10dd9"><td class="memItemLeft" align="right" valign="top"><a id="aab42e835e95b6eca7addbff679c10dd9"></a>
typedef struct <a class="el" href="structAUDIO__SETTINGS.html">AUDIO_SETTINGS</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dvdparser_8cc.html#aab42e835e95b6eca7addbff679c10dd9">AUDIO_SETTINGS</a></td></tr>
<tr class="memdesc:aab42e835e95b6eca7addbff679c10dd9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Audio stream settings. <br /></td></tr>
<tr class="separator:aab42e835e95b6eca7addbff679c10dd9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a284c86eaa4b7f0afa5c9fc859c85e494"><td class="memItemLeft" align="right" valign="top"><a id="a284c86eaa4b7f0afa5c9fc859c85e494"></a>
typedef <a class="el" href="structAUDIO__SETTINGS.html">AUDIO_SETTINGS</a> const  *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dvdparser_8cc.html#a284c86eaa4b7f0afa5c9fc859c85e494">LPCAUDIO_SETTINGS</a></td></tr>
<tr class="memdesc:a284c86eaa4b7f0afa5c9fc859c85e494"><td class="mdescLeft">&#160;</td><td class="mdescRight">Pointer to const version of <a class="el" href="structAUDIO__SETTINGS.html" title="Audio stream settings.">AUDIO_SETTINGS</a>. <br /></td></tr>
<tr class="separator:a284c86eaa4b7f0afa5c9fc859c85e494"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2eb718e9c69f88711fe51dc4ea01ea90"><td class="memItemLeft" align="right" valign="top"><a id="a2eb718e9c69f88711fe51dc4ea01ea90"></a>
typedef <a class="el" href="structAUDIO__SETTINGS.html">AUDIO_SETTINGS</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dvdparser_8cc.html#a2eb718e9c69f88711fe51dc4ea01ea90">LPAUDIO_SETTINGS</a></td></tr>
<tr class="memdesc:a2eb718e9c69f88711fe51dc4ea01ea90"><td class="mdescLeft">&#160;</td><td class="mdescRight">Pointer version of <a class="el" href="structAUDIO__SETTINGS.html" title="Audio stream settings.">AUDIO_SETTINGS</a>. <br /></td></tr>
<tr class="separator:a2eb718e9c69f88711fe51dc4ea01ea90"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aec8ce7cca41cd4bb2aceb4a5d25bd117"><td class="memItemLeft" align="right" valign="top"><a id="aec8ce7cca41cd4bb2aceb4a5d25bd117"></a>
typedef struct <a class="el" href="structVIDEO__SETTINGS.html">VIDEO_SETTINGS</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dvdparser_8cc.html#aec8ce7cca41cd4bb2aceb4a5d25bd117">VIDEO_SETTINGS</a></td></tr>
<tr class="memdesc:aec8ce7cca41cd4bb2aceb4a5d25bd117"><td class="mdescLeft">&#160;</td><td class="mdescRight">Video stream settings. <br /></td></tr>
<tr class="separator:aec8ce7cca41cd4bb2aceb4a5d25bd117"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0ad823494ac90eb1ab6de49ef3edf341"><td class="memItemLeft" align="right" valign="top"><a id="a0ad823494ac90eb1ab6de49ef3edf341"></a>
typedef <a class="el" href="structVIDEO__SETTINGS.html">VIDEO_SETTINGS</a> const  *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dvdparser_8cc.html#a0ad823494ac90eb1ab6de49ef3edf341">LPCVIDEO_SETTINGS</a></td></tr>
<tr class="memdesc:a0ad823494ac90eb1ab6de49ef3edf341"><td class="mdescLeft">&#160;</td><td class="mdescRight">Pointer to const version of <a class="el" href="structVIDEO__SETTINGS.html" title="Video stream settings.">VIDEO_SETTINGS</a>. <br /></td></tr>
<tr class="separator:a0ad823494ac90eb1ab6de49ef3edf341"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8a7656707ef403c09d8a50711eabed76"><td class="memItemLeft" align="right" valign="top"><a id="a8a7656707ef403c09d8a50711eabed76"></a>
typedef <a class="el" href="structVIDEO__SETTINGS.html">VIDEO_SETTINGS</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dvdparser_8cc.html#a8a7656707ef403c09d8a50711eabed76">LPVIDEO_SETTINGS</a></td></tr>
<tr class="memdesc:a8a7656707ef403c09d8a50711eabed76"><td class="mdescLeft">&#160;</td><td class="mdescRight">Pointer version of <a class="el" href="structVIDEO__SETTINGS.html" title="Video stream settings.">VIDEO_SETTINGS</a>. <br /></td></tr>
<tr class="separator:a8a7656707ef403c09d8a50711eabed76"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ac9baf91679a9e422818be34ff1e39072"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dvdparser_8cc.html#ac9baf91679a9e422818be34ff1e39072">dvd_find_best_audio_stream</a> (const vtsi_mat_t *vtsi_mat, int *best_channels, int *best_sample_frequency)</td></tr>
<tr class="memdesc:ac9baf91679a9e422818be34ff1e39072"><td class="mdescLeft">&#160;</td><td class="mdescRight">Locate best matching audio stream.  <a href="dvdparser_8cc.html#ac9baf91679a9e422818be34ff1e39072">More...</a><br /></td></tr>
<tr class="separator:ac9baf91679a9e422818be34ff1e39072"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a546edd44f72c3b6078cf40d298439062"><td class="memItemLeft" align="right" valign="top">static AVRational&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dvdparser_8cc.html#a546edd44f72c3b6078cf40d298439062">dvd_frame_rate</a> (const uint8_t *ptr)</td></tr>
<tr class="memdesc:a546edd44f72c3b6078cf40d298439062"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the frame rate of the DVD. Can be 25 fps (PAL) or 29.97 (NTCS).  <a href="dvdparser_8cc.html#a546edd44f72c3b6078cf40d298439062">More...</a><br /></td></tr>
<tr class="separator:a546edd44f72c3b6078cf40d298439062"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a42340401b3eae010e3913439fd3e6058"><td class="memItemLeft" align="right" valign="top">static int64_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dvdparser_8cc.html#a42340401b3eae010e3913439fd3e6058">BCDtime</a> (const dvd_time_t *dvd_time)</td></tr>
<tr class="memdesc:a42340401b3eae010e3913439fd3e6058"><td class="mdescLeft">&#160;</td><td class="mdescRight">Convert a time in BCD format into AV_TIMEBASE fractional seconds.  <a href="dvdparser_8cc.html#a42340401b3eae010e3913439fd3e6058">More...</a><br /></td></tr>
<tr class="separator:a42340401b3eae010e3913439fd3e6058"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a492e2e1960310e6b55fa7d7b83ecc931"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dvdparser_8cc.html#a492e2e1960310e6b55fa7d7b83ecc931">create_dvd_virtualfile</a> (const ifo_handle_t *vts_file, const std::string &amp;path, const struct stat *statbuf, void *buf, fuse_fill_dir_t filler, bool full_title, int title_idx, int chapter_idx, int angles, int ttnnum, int audio_stream, const <a class="el" href="structAUDIO__SETTINGS.html">AUDIO_SETTINGS</a> &amp;audio_settings, const <a class="el" href="structVIDEO__SETTINGS.html">VIDEO_SETTINGS</a> &amp;video_settings)</td></tr>
<tr class="memdesc:a492e2e1960310e6b55fa7d7b83ecc931"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create a virtual file for a DVD.  <a href="dvdparser_8cc.html#a492e2e1960310e6b55fa7d7b83ecc931">More...</a><br /></td></tr>
<tr class="separator:a492e2e1960310e6b55fa7d7b83ecc931"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae4cba40b0b1282b135badb16cbf44e33"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dvdparser_8cc.html#ae4cba40b0b1282b135badb16cbf44e33">parse_dvd</a> (const std::string &amp;path, const struct stat *statbuf, void *buf, fuse_fill_dir_t filler)</td></tr>
<tr class="memdesc:ae4cba40b0b1282b135badb16cbf44e33"><td class="mdescLeft">&#160;</td><td class="mdescRight">Parse DVD directory and get all DVD titles and chapters as virtual files.  <a href="dvdparser_8cc.html#ae4cba40b0b1282b135badb16cbf44e33">More...</a><br /></td></tr>
<tr class="separator:ae4cba40b0b1282b135badb16cbf44e33"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a218a7a882ce8cc59dcd996adbeb1fd44"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dvdparser_8cc.html#a218a7a882ce8cc59dcd996adbeb1fd44">check_dvd</a> (const std::string &amp;_path, void *buf, fuse_fill_dir_t filler)</td></tr>
<tr class="memdesc:a218a7a882ce8cc59dcd996adbeb1fd44"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get number of titles on DVD.  <a href="dvdparser_8cc.html#a218a7a882ce8cc59dcd996adbeb1fd44">More...</a><br /></td></tr>
<tr class="separator:a218a7a882ce8cc59dcd996adbeb1fd44"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>dvdparser class implementation </p>
<dl class="section author"><dt>Author</dt><dd>Norbert Schlia (<a href="#" onclick="location.href='mai'+'lto:'+'nsc'+'hl'+'ia@'+'ob'+'liv'+'io'+'n-s'+'of'+'twa'+'re'+'.de'; return false;">nschl<span style="display: none;">.nosp@m.</span>ia@o<span style="display: none;">.nosp@m.</span>blivi<span style="display: none;">.nosp@m.</span>on-s<span style="display: none;">.nosp@m.</span>oftwa<span style="display: none;">.nosp@m.</span>re.d<span style="display: none;">.nosp@m.</span>e</a>) </dd></dl>
<dl class="section copyright"><dt>Copyright</dt><dd>Copyright (C) 2017-2021 Norbert Schlia (<a href="#" onclick="location.href='mai'+'lto:'+'nsc'+'hl'+'ia@'+'ob'+'liv'+'io'+'n-s'+'of'+'twa'+'re'+'.de'; return false;">nschl<span style="display: none;">.nosp@m.</span>ia@o<span style="display: none;">.nosp@m.</span>blivi<span style="display: none;">.nosp@m.</span>on-s<span style="display: none;">.nosp@m.</span>oftwa<span style="display: none;">.nosp@m.</span>re.d<span style="display: none;">.nosp@m.</span>e</a>) </dd></dl>

<p class="definition">Definition in file <a class="el" href="dvdparser_8cc_source.html">dvdparser.cc</a>.</p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a42340401b3eae010e3913439fd3e6058"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a42340401b3eae010e3913439fd3e6058">&#9670;&nbsp;</a></span>BCDtime()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int64_t BCDtime </td>
          <td>(</td>
          <td class="paramtype">const dvd_time_t *&#160;</td>
          <td class="paramname"><em>dvd_time</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Convert a time in BCD format into AV_TIMEBASE fractional seconds. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">dvd_time</td><td>- dvd_time_t object. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Time in AV_TIMEBASE fractional seconds. </dd></dl>

<p class="definition">Definition at line <a class="el" href="dvdparser_8cc_source.html#l00203">203</a> of file <a class="el" href="dvdparser_8cc_source.html">dvdparser.cc</a>.</p>

<p class="reference">References <a class="el" href="dvdparser_8cc_source.html#l00168">dvd_frame_rate()</a>.</p>

<p class="reference">Referenced by <a class="el" href="dvdparser_8cc_source.html#l00243">create_dvd_virtualfile()</a>.</p>

</div>
</div>
<a id="a218a7a882ce8cc59dcd996adbeb1fd44"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a218a7a882ce8cc59dcd996adbeb1fd44">&#9670;&nbsp;</a></span>check_dvd()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int check_dvd </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>path</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>buf</em> = <code>nullptr</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">fuse_fill_dir_t&#160;</td>
          <td class="paramname"><em>filler</em> = <code>nullptr</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get number of titles on DVD. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">path</td><td>- Path to check </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">buf</td><td>- The buffer passed to the readdir() operation. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">filler</td><td>- Function to add an entry in a readdir() operation (see0 </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>-errno or number or titles on DVD </dd></dl>

<p class="definition">Definition at line <a class="el" href="dvdparser_8cc_source.html#l00545">545</a> of file <a class="el" href="dvdparser_8cc_source.html">dvdparser.cc</a>.</p>

<p class="reference">References <a class="el" href="fuseops_8cc_source.html#l02183">add_dotdot()</a>, <a class="el" href="ffmpeg__utils_8cc_source.html#l00288">append_sep()</a>, <a class="el" href="fuseops_8cc_source.html#l00524">check_path()</a>, <a class="el" href="fuseops_8cc_source.html#l00531">load_path()</a>, <a class="el" href="dvdparser_8cc_source.html#l00420">parse_dvd()</a>, and <a class="el" href="logging_8h_source.html#l00162">Logging::trace()</a>.</p>

<p class="reference">Referenced by <a class="el" href="fuseops_8cc_source.html#l01240">ffmpegfs_getattr()</a>, and <a class="el" href="fuseops_8cc_source.html#l00967">ffmpegfs_readdir()</a>.</p>

</div>
</div>
<a id="a492e2e1960310e6b55fa7d7b83ecc931"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a492e2e1960310e6b55fa7d7b83ecc931">&#9670;&nbsp;</a></span>create_dvd_virtualfile()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static bool create_dvd_virtualfile </td>
          <td>(</td>
          <td class="paramtype">const ifo_handle_t *&#160;</td>
          <td class="paramname"><em>vts_file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>path</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct stat *&#160;</td>
          <td class="paramname"><em>statbuf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">fuse_fill_dir_t&#160;</td>
          <td class="paramname"><em>filler</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>full_title</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>title_idx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>chapter_idx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>angles</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ttnnum</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>audio_stream</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structAUDIO__SETTINGS.html">AUDIO_SETTINGS</a> &amp;&#160;</td>
          <td class="paramname"><em>audio_settings</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structVIDEO__SETTINGS.html">VIDEO_SETTINGS</a> &amp;&#160;</td>
          <td class="paramname"><em>video_settings</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Create a virtual file for a DVD. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">vts_file</td><td>- Structure defines an IFO file </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">path</td><td>- Path to DVD files. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">statbuf</td><td>- File status structure of original file. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">buf</td><td>- The buffer passed to the readdir() operation. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">filler</td><td>- Function to add an entry in a readdir() operation (see <a href="https://libfuse.github.io/doxygen/fuse_8h.html#a7dd132de66a5cc2add2a4eff5d435660">https://libfuse.github.io/doxygen/fuse_8h.html#a7dd132de66a5cc2add2a4eff5d435660</a>) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">full_title</td><td>- If true, create virtual file of all title. If false, include single chapter only. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">title_idx</td><td>- Index of DVD title. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">chapter_idx</td><td>- Index of DVD chapter. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">angles</td><td>- Number of angles. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ttnnum</td><td>- DVD title number. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">audio_stream</td><td>- Audio stream index. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">audio_settings</td><td>- Audio stream settings. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">video_settings</td><td>- Video stream settings. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Returns true if successful. Returns false on error. </dd></dl>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000009">Todo:</a></b></dt><dd>We actually calculate the overall DVD bitrate here, including all audio streams, not just the video bitrate. This should be the video bitrate alone. We should also calculate the audio bitrate for the selected stream. </dd></dl>

<p class="definition">Definition at line <a class="el" href="dvdparser_8cc_source.html#l00243">243</a> of file <a class="el" href="dvdparser_8cc_source.html">dvdparser.cc</a>.</p>

<p class="reference">References <a class="el" href="fuseops_8cc_source.html#l02173">add_fuse_entry()</a>, <a class="el" href="dvdparser_8cc_source.html#l00203">BCDtime()</a>, <a class="el" href="ffmpeg__utils_8h_source.html#l00156">BITRATE</a>, <a class="el" href="logging_8h_source.html#l00185">Logging::debug()</a>, <a class="el" href="dvdparser_8cc_source.html#l00168">dvd_frame_rate()</a>, <a class="el" href="logging_8h_source.html#l00254">Logging::error()</a>, <a class="el" href="ffmpeg__utils_8cc_source.html#l00253">FFmpegfs_Format::fileext()</a>, <a class="el" href="ffmpeg__utils_8cc_source.html#l00805">format_bitrate()</a>, <a class="el" href="ffmpeg__utils_8cc_source.html#l00846">format_duration()</a>, <a class="el" href="ffmpeg__utils_8cc_source.html#l00924">format_size()</a>, <a class="el" href="fuseops_8cc_source.html#l00481">insert_dir()</a>, <a class="el" href="fuseops_8cc_source.html#l00438">insert_file()</a>, <a class="el" href="ffmpeg__utils_8cc_source.html#l00263">FFmpegfs_Format::is_multiformat()</a>, <a class="el" href="fileio_8h_source.html#l00179">VIRTUALFILE::DVD_CHAPTER::m_angle_no</a>, <a class="el" href="dvdparser_8cc_source.html#l00049">AUDIO_SETTINGS::m_audio_bit_rate</a>, <a class="el" href="dvdparser_8cc_source.html#l00050">AUDIO_SETTINGS::m_channels</a>, <a class="el" href="fileio_8h_source.html#l00178">VIRTUALFILE::DVD_CHAPTER::m_chapter_no</a>, <a class="el" href="fileio_8h_source.html#l00137">VIRTUALFILE::m_destfile</a>, <a class="el" href="fileio_8h_source.html#l00142">VIRTUALFILE::m_duration</a>, <a class="el" href="structVIRTUALFILE.html#a13ea53dfe484496bc27060e71d249b6b">VIRTUALFILE::m_dvd</a>, <a class="el" href="ffmpegfs_8h_source.html#l00136">FFMPEGFS_PARAMS::m_format</a>, <a class="el" href="fileio_8h_source.html#l00136">VIRTUALFILE::m_format_idx</a>, <a class="el" href="fileio_8h_source.html#l00141">VIRTUALFILE::m_full_title</a>, <a class="el" href="dvdparser_8cc_source.html#l00060">VIDEO_SETTINGS::m_height</a>, <a class="el" href="ffmpegfs_8h_source.html#l00175">FFMPEGFS_PARAMS::m_min_dvd_chapter_duration</a>, <a class="el" href="fileio_8h_source.html#l00143">VIRTUALFILE::m_predicted_size</a>, <a class="el" href="dvdparser_8cc_source.html#l00051">AUDIO_SETTINGS::m_sample_rate</a>, <a class="el" href="fileio_8h_source.html#l00139">VIRTUALFILE::m_st</a>, <a class="el" href="fileio_8h_source.html#l00177">VIRTUALFILE::DVD_CHAPTER::m_title_no</a>, <a class="el" href="dvdparser_8cc_source.html#l00058">VIDEO_SETTINGS::m_video_bit_rate</a>, <a class="el" href="fileio_8h_source.html#l00144">VIRTUALFILE::m_video_frame_count</a>, <a class="el" href="dvdparser_8cc_source.html#l00059">VIDEO_SETTINGS::m_width</a>, <a class="el" href="ffmpegfs_8cc_source.html#l00066">params</a>, <a class="el" href="ffmpeg__utils_8cc_source.html#l01098">replace_all()</a>, <a class="el" href="logging_8h_source.html#l00162">Logging::trace()</a>, <a class="el" href="transcode_8cc_source.html#l00246">transcoder_cached_filesize()</a>, <a class="el" href="transcode_8cc_source.html#l00273">transcoder_set_filesize()</a>, and <a class="el" href="fileio_8h_source.html#l00095">VIRTUALTYPE_DVD</a>.</p>

<p class="reference">Referenced by <a class="el" href="dvdparser_8cc_source.html#l00420">parse_dvd()</a>.</p>

</div>
</div>
<a id="ac9baf91679a9e422818be34ff1e39072"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac9baf91679a9e422818be34ff1e39072">&#9670;&nbsp;</a></span>dvd_find_best_audio_stream()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int dvd_find_best_audio_stream </td>
          <td>(</td>
          <td class="paramtype">const vtsi_mat_t *&#160;</td>
          <td class="paramname"><em>vtsi_mat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>best_channels</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>best_sample_frequency</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Locate best matching audio stream. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">vtsi_mat</td><td>- Video Title Set Information (VTSI) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">best_channels</td><td>- Number of channels in best stream. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">best_sample_frequency</td><td>- Sample frequency in best stream. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Returns number of best stream (0..8). </dd></dl>

<p class="definition">Definition at line <a class="el" href="dvdparser_8cc_source.html#l00078">78</a> of file <a class="el" href="dvdparser_8cc_source.html">dvdparser.cc</a>.</p>

<p class="reference">Referenced by <a class="el" href="dvdparser_8cc_source.html#l00420">parse_dvd()</a>.</p>

</div>
</div>
<a id="a546edd44f72c3b6078cf40d298439062"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a546edd44f72c3b6078cf40d298439062">&#9670;&nbsp;</a></span>dvd_frame_rate()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static AVRational dvd_frame_rate </td>
          <td>(</td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>ptr</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get the frame rate of the DVD. Can be 25 fps (PAL) or 29.97 (NTCS). </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ptr</td><td>- Pointer to frame_u element in dvd_time_t structure. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>On success returns AVRational with frame rate. On error returns frame rate { 0, 0 }. </dd></dl>

<p class="definition">Definition at line <a class="el" href="dvdparser_8cc_source.html#l00168">168</a> of file <a class="el" href="dvdparser_8cc_source.html">dvdparser.cc</a>.</p>

<p class="reference">Referenced by <a class="el" href="dvdparser_8cc_source.html#l00203">BCDtime()</a>, and <a class="el" href="dvdparser_8cc_source.html#l00243">create_dvd_virtualfile()</a>.</p>

</div>
</div>
<a id="ae4cba40b0b1282b135badb16cbf44e33"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae4cba40b0b1282b135badb16cbf44e33">&#9670;&nbsp;</a></span>parse_dvd()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int parse_dvd </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>path</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct stat *&#160;</td>
          <td class="paramname"><em>statbuf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">fuse_fill_dir_t&#160;</td>
          <td class="paramname"><em>filler</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Parse DVD directory and get all DVD titles and chapters as virtual files. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">path</td><td>- Path to check. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">statbuf</td><td>- File status structure of original file. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">buf</td><td>- The buffer passed to the readdir() operation. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">filler</td><td>- Function to add an entry in a readdir() operation (see <a href="https://libfuse.github.io/doxygen/fuse_8h.html#a7dd132de66a5cc2add2a4eff5d435660">https://libfuse.github.io/doxygen/fuse_8h.html#a7dd132de66a5cc2add2a4eff5d435660</a>) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>On success, returns number of chapters found. On error, returns -errno. </dd></dl>

<p class="definition">Definition at line <a class="el" href="dvdparser_8cc_source.html#l00420">420</a> of file <a class="el" href="dvdparser_8cc_source.html">dvdparser.cc</a>.</p>

<p class="reference">References <a class="el" href="dvdparser_8cc_source.html#l00243">create_dvd_virtualfile()</a>, <a class="el" href="logging_8h_source.html#l00185">Logging::debug()</a>, <a class="el" href="dvdparser_8cc_source.html#l00078">dvd_find_best_audio_stream()</a>, <a class="el" href="logging_8h_source.html#l00254">Logging::error()</a>, <a class="el" href="dvdparser_8cc_source.html#l00049">AUDIO_SETTINGS::m_audio_bit_rate</a>, <a class="el" href="dvdparser_8cc_source.html#l00050">AUDIO_SETTINGS::m_channels</a>, <a class="el" href="dvdparser_8cc_source.html#l00060">VIDEO_SETTINGS::m_height</a>, <a class="el" href="dvdparser_8cc_source.html#l00051">AUDIO_SETTINGS::m_sample_rate</a>, <a class="el" href="dvdparser_8cc_source.html#l00058">VIDEO_SETTINGS::m_video_bit_rate</a>, <a class="el" href="dvdparser_8cc_source.html#l00059">VIDEO_SETTINGS::m_width</a>, <a class="el" href="logging_8h_source.html#l00162">Logging::trace()</a>, and <a class="el" href="logging_8h_source.html#l00231">Logging::warning()</a>.</p>

<p class="reference">Referenced by <a class="el" href="dvdparser_8cc_source.html#l00545">check_dvd()</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
